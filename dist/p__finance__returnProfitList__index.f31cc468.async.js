(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{Cxew:function(e,t,a){"use strict";a.r(t);a("14J3");var n,r,i,l=a("BMrR"),o=(a("jCWc"),a("kPKH")),c=a("2Taf"),s=a.n(c),u=a("vZ4D"),d=a.n(u),m=a("MhPg"),f=a.n(m),p=a("l4Ni"),v=a.n(p),h=a("ujKo"),E=a.n(h),y=a("9UV2"),g=a.n(y),_=a("MuoO"),b=a("q1tI"),x=a.n(b),I=a("Kvkj"),L=a("7Qib"),D=a("F1Dt"),P=a("gWZ8"),k=a.n(P),M=a("wd/R"),O=a.n(M),w=a("tUHX"),C=a("xvlK"),j=(a("bbsP"),a("/wGt")),R=(a("g9YV"),a("wCAj")),T=a("qIgq"),N=a.n(T),S=function(e){var t=e.visible,a=e.params,n=void 0===a?{}:a,r=e.onCancel,i=Object(b["useState"])([]),l=N()(i,2),o=l[0],c=l[1],s=Object(b["useState"])(!1),u=N()(s,2),d=u[0],m=u[1];Object(b["useEffect"])(function(){n&&Object.values(n).every(function(e){return e})&&(m(!0),$api.finance.getRebateDetail(n).then(function(e){var t=e&&e.data;c(t||[])}).then(function(e){m(!1)}).catch(function(e){m(!1)}))},[n]);var f=function(){r&&r()};return x.a.createElement(j["a"],{title:"\u8fd4\u5229\u660e\u7ec6",visible:t,onClose:f,placement:"right",width:"1000"},x.a.createElement(R["a"],{columns:A,dataSource:o,pagination:!1,loading:d}))},q=a("rcax"),K=a.n(q),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e?[{value:-1,name:"\u5168\u90e8"}].concat(k()(e)):[{value:-1,name:"\u5168\u90e8"}];return[{type:"enum",key:"status",placeholder:"\u5168\u90e8\u8fd4\u5229\u72b6\u6001",enums:t},{key:"timeType",placeholder:"\u8fd4\u4f63\u5f00\u59cb\u65f6\u95f4",enums:[{value:0,name:"\u8fd4\u4f63\u5f00\u59cb\u65f6\u95f4"},{value:1,name:"\u8fd4\u4f63\u5b8c\u6210\u65f6\u95f4"}]},{key:"time",searchKeys:["start_time","end_time"],placeholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"],type:"dateRange",inputProps:{ranges:D["c"],disabledDate:function(e){return e<O()().subtract(3,"months")||e>O()().endOf("day")}},initialValue:[O()().subtract(30,"days"),O()()]},{key:"member_id",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d/ID\u641c\u7d22"},{key:"order_no",placeholder:"\u8bf7\u8f93\u5165\u8ba2\u5355\u53f7\u641c\u7d22"}]},$=function(e){var t=this;return[{title:"\u8fd4\u4f63\u5f00\u59cb\u65f6\u95f4",dataIndex:"created_at",render:function(e,t){return x.a.createElement("span",null,e&&O()(1e3*e).format(D["d"].DATETIME))}},{title:"\u7528\u6237\u540d / ID",dataIndex:"nickname",render:function(e,t){return x.a.createElement("span",null,e,"\xa0/\xa0",t.member_id)}},{title:"\u5546\u54c1",dataIndex:"goods_name",render:function(e){return x.a.createElement("div",{style:{width:"300px"}},x.a.createElement(I["r"],{text:e,maxLine:"1"}))}},{title:"\u8ba2\u5355\u53f7",dataIndex:"order_no",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0;return $api.order.getOrderDetail.permission()?x.a.createElement("a",{onClick:function(){t.routeToOrder(a&&a.order_id)}},e):e}},{title:"\u8fd4\u4f63\u91d1\u989d",dataIndex:"money",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";arguments.length>1&&arguments[1];return e<0?x.a.createElement("div",null,x.a.createElement("span",null,x.a.createElement(w["a"],{style:{color:"#d9001b",fontSize:"12px"}}),"\xa0",g.a.formatMoney(Math.abs(e),"\uffe5"))):x.a.createElement("div",null,x.a.createElement("span",null,x.a.createElement(C["a"],{style:{color:"#70b603",fontSize:"12px"}}),"\xa0",g.a.formatMoney(e,"\uffe5")))}},{title:"\u8fd4\u4f63\u72b6\u6001",dataIndex:"status",render:function(t){return x.a.createElement("span",null,e[t])}},{title:"\u8fd4\u4f63\u5b8c\u6210\u65f6\u95f4",dataIndex:"updated_at",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";arguments.length>1&&arguments[1];return x.a.createElement("span",null,e&&O()(1e3*e).format(D["d"].DATETIME))}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return $api.finance.getRebateDetail.permission()&&x.a.createElement("a",{onClick:function(){t.onOpenDetailsModal(e)}},"\u67e5\u770b\u660e\u7ec6")}}]},A=[{title:"\u7528\u6237\u540d / ID",dataIndex:"member_id",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.nickname,n=void 0===a?"":a;return x.a.createElement("div",null,n,"\xa0/\xa0",e)}},{title:"\u8fd4\u4f63\u91d1\u989d",dataIndex:"money"},{title:"\u5546\u54c1",dataIndex:"goods_title",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return x.a.createElement("div",{style:{width:"300px"}},x.a.createElement(I["r"],{text:e,maxLine:"1"}))}},{title:"\u5907\u6ce8",dataIndex:"remark"},{title:"\u72b6\u6001",dataIndex:"status_text"}];function G(e){return function(){var t,a=E()(e);if(H()){var n=E()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return v()(this,t)}}function H(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var U=(n=Object(_["connect"])(function(e){var t=e.returnProfitList,a=e.loading;return{returnProfitList:t,loading:a}}),n((i=function(e){f()(a,e);var t=G(a);function a(e){var n;return s()(this,a),n=t.call(this,e),n.onSearch=function(e){var t=n.props.dispatch;t({type:"returnProfitList/onSearch",payload:e}),t({type:"returnProfitList/getList",payload:e})},n.getList=function(e){var t=n.props.dispatch;t({type:"returnProfitList/getList",payload:e})},n.routeToOrder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";L["j"].push({pathname:"/order/orderDetail/".concat(e)})},n.onOpenDetailsModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n.setState({detailsModal:!0,details:e})},n.toggleDetailsModal=function(){n.setState(function(e){return{detailsModal:!e.detailsModal}})},n.state={detailsModal:!1,details:{}},n}return d()(a,[{key:"renderTotals",value:function(){var e=this.props.returnProfitList.sum,t=void 0===e?{}:e,a=t||{},n=a.order_num,r=a.total_amount,i=a.rebated,c=a.rebating;return x.a.createElement(l["a"],{type:"flex",justify:"space-around",className:K.a.totalRow,gutter:16},x.a.createElement(o["a"],{span:6},x.a.createElement("div",{className:K.a.totalCol},x.a.createElement("div",null,x.a.createElement("span",null,"\u603b\u4e0b\u5355\u6570\u91cf"),x.a.createElement("span",{className:K.a.num},g.a.formatNumber(n))))),x.a.createElement(o["a"],{span:6},x.a.createElement("div",{className:K.a.totalCol},x.a.createElement("div",null,x.a.createElement("span",null,"\u603b\u8fd4\u4f63\u91d1\u989d"),x.a.createElement("span",{className:K.a.num},g.a.formatMoney(r,"\uffe5"))))),x.a.createElement(o["a"],{span:6},x.a.createElement("div",{className:K.a.totalCol},x.a.createElement("div",null,x.a.createElement("span",null,"\u5df2\u8fd4\u4f63\u91d1\u989d"),x.a.createElement("span",{className:K.a.num},g.a.formatMoney(i,"\uffe5"))))),x.a.createElement(o["a"],{span:6},x.a.createElement("div",{className:K.a.totalCol},x.a.createElement("div",null,x.a.createElement("span",null,"\u5f85\u8fd4\u4f63\u91d1\u989d"),x.a.createElement("span",{className:K.a.num},g.a.formatMoney(c,"\uffe5"))))))}},{key:"renderDetails",value:function(){var e=this.state,t=e.detailsModal,a=e.details,n=void 0===a?{}:a,r=n||{},i=r.id,l=void 0===i?"":i,o=r.member_id,c=void 0===o?"":o,s=r.order_id,u=void 0===s?"":s,d={rebate_id:l,member_id:c,order_id:u};return x.a.createElement(S,{visible:t,onCancel:this.toggleDetailsModal,params:d})}},{key:"renderList",value:function(){var e=this.props,t=e.returnProfitList,a=e.loading,n=t.list,r=void 0===n?[]:n,i=t.pagination,l=t.status,o=void 0===l?{}:l,c=t.query,s=o&&Object.keys(o)&&Object.keys(o).reduce(function(e,t){return e.concat([{value:t,name:o[t]}])},[]),u={search:c};return x.a.createElement(I["i"],{dataSource:r,pagination:i,searchProp:u,searchFields:J.call(this,s),columns:$.call(this,o),loading:a.effects["returnProfitList/getList"],onSearch:this.onSearch,getList:this.getList})}},{key:"render",value:function(){var e=this.props.returnProfitList.query,t=void 0===e?"":e,a=[{type:"export",name:"\u5bfc\u51fa",url:$api.finance.returnProfitExport.url,query:t,permission:Object(D["m"])("returnProfitExport")}].filter(function(e){return e.permission});return x.a.createElement(I["x"],{inner:!0,className:K.a.returnProfitList},x.a.createElement(I["y"],{btns:a,className:K.a.totalTitle}),this.renderTotals(),this.renderList(),this.renderDetails())}}]),a}(b["PureComponent"]),r=i))||r);t["default"]=U},rcax:function(e,t,a){e.exports={returnProfitList:"returnProfitList____Os3n",totalTitle:"totalTitle___3yUli",totalRow:"totalRow___iJmDK",totalCol:"totalCol___RyHO_",num:"num___1-nTl",title:"title___1GIJY",questionIcon:"questionIcon___2C1tG"}}}]);