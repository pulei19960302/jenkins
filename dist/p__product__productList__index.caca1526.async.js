(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[70],{a2TT:function(t,e,a){"use strict";a.r(e);var r,o,i,n=a("p0pE"),c=a.n(n),u=a("gWZ8"),s=a.n(u),d=(a("2qtc"),a("kLXV")),p=(a("miYZ"),a("tsqr")),l=a("2Taf"),m=a.n(l),f=a("vZ4D"),h=a.n(f),g=a("MhPg"),y=a.n(g),L=a("l4Ni"),v=a.n(L),E=a("ujKo"),P=a.n(E),_=a("MuoO"),S=a("q1tI"),k=a.n(S),b=a("Kvkj"),w=a("KLZ9"),R={editProduct:{permission:$api.product.editProduct.permission()},addProduct:{permission:$api.product.addProduct.permission()},productHandle:{permission:$api.product.productHandle.permission()},productDetail:{permission:$api.product.productDetail.permission()},productPreStart:{permission:$api.product.productPreStart.permission()},productDelete:{permission:$api.product.productDelete.permission()},productEditLabel:{permission:$api.product.productEditLabel.permission()},productExport:{permission:$api.product.productExport.permission()}},x=function(t){return!!t&&R[t].permission},I={PRELOADING:"1",UPPER_SHELF:"2",LOWER_SHELF:"3",EARLY_WARNING:"4",SELL_OUT:"5"},D={0:"\u5df2\u5220\u9664",1:"\u9884\u4e0a\u67b6",2:"\u5df2\u4e0a\u67b6",3:"\u5df2\u4e0b\u67b6",4:"\u9884\u8b66",5:"\u5df2\u552e\u7f44"},H=(a("/zsF"),a("PArb")),O=(a("BoS7"),a("Sdc0")),C=a("u2V1"),F=[{title:"\u5168\u90e8\u5546\u54c1",value:"-1"},{title:"\u5df2\u4e0a\u67b6",value:I.UPPER_SHELF},{title:"\u9884\u4e0a\u67b6",value:I.PRELOADING},{title:"\u5df2\u4e0b\u67b6",value:I.LOWER_SHELF},{title:"\u9884\u8b66",value:I.EARLY_WARNING},{title:"\u552e\u7f44",value:I.SELL_OUT}],$=function(t){return 0===t.length?[]:t.map(function(t){return{title:t.name,value:t.id,children:0===t.sub.length?[]:t.sub.map(function(t){return{title:t.name,value:t.id}})}})},T=function(){var t=this.state,e=t.supplierList,a=t.categoryList;return[{key:"goods_id",placeholder:"\u5546\u54c1id"},{key:"keywords",placeholder:"\u5546\u54c1\u540d\u79f0"},{type:"treeSelect",key:"goods_category_ids",inputProps:{placeholder:"\u5546\u54c1\u7c7b\u76ee",treeData:$(a),multiple:!0}},{type:"enum",key:"supplier_id",placeholder:"\u4f9b\u5e94\u5546",enums:e.map(function(t){return{name:t.name,value:t.id}})}]},A=function(){var t=this;return[{title:"\u5546\u54c1ID",dataIndex:"goods_id",width:100},{title:"\u5546\u54c1",dataIndex:"main_img",width:60,imgWidth:40,imgHeight:40,previewImg:!0},{title:"",dataIndex:"title",width:180,tableOverflow:!0,maxLine:2},{title:"\u603b\u5e93\u5b58",dataIndex:"total_stock",render:function(t,e){var a=+e.total_stock<+e.warning_value;return k.a.createElement("div",null,k.a.createElement("span",null,e.total_stock),a&&k.a.createElement(C["a"],{twoToneColor:"#ff4d4f",style:{marginLeft:4}}))}},{title:"\u603b\u9500\u91cf",dataIndex:"total_sale_num"},{title:"\u5546\u54c1\u7c7b\u76ee",dataIndex:"category_str"},{title:"\u4f9b\u5e94\u5546",dataIndex:"supplier_str"},{title:"\u4fee\u6539\u65f6\u95f4",dataIndex:"updated_at"},{title:"\u4e0a\u4e0b\u67b6\u72b6\u6001",dataIndex:"goods_status",render:function(e,a){var r=2===a.goods_status;return k.a.createElement("div",null,D[a.goods_status],x("productHandle")&&k.a.createElement(O["a"],{checked:r,style:{marginLeft:5,verticalAlign:"bottom"},onChange:function(e){return t.changeProductStatus([a.goods_id],e?I.UPPER_SHELF:I.LOWER_SHELF)}}))}},{title:"\u64cd\u4f5c",dataIndex:"operate",width:160,render:function(e,a){return k.a.createElement("div",null,x("editProduct")&&k.a.createElement(S["Fragment"],null,k.a.createElement("a",{onClick:function(){t.editProduct(a.goods_id)}},"\u7f16\u8f91"),k.a.createElement(H["a"],{type:"vertical"})),x("addProduct")&&k.a.createElement(S["Fragment"],null,k.a.createElement("a",{onClick:function(){t.copyProduct(a.goods_id)}},"\u590d\u5236"),k.a.createElement(H["a"],{type:"vertical"})),x("productDelete")&&k.a.createElement("a",{onClick:function(){t.deleteProducts([a.goods_id])}},"\u5220\u9664"))}}]},N=[{name:"\u4e0a\u67b6",key:"putaway",permisison:x("productHandle")},{name:"\u4e0b\u67b6",key:"outOfStock",permisison:x("productHandle")},{name:"\u5220\u9664",key:"del",permisison:x("productDelete")}].filter(function(t){return t.permisison});function W(t){return function(){var e,a=P()(t);if(K()){var r=P()(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return v()(this,e)}}function K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}var U=(r=Object(_["connect"])(function(t){var e=t.productList,a=t.loading;return{loading:a,productList:e}}),r((i=function(t){y()(a,t);var e=W(a);function a(){var t;m()(this,a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),t.state={supplierList:[],categoryList:[]},t.tabsChange=function(e){var a=e.value,r=t.props.dispatch;r({type:"productList/updateState",payload:{goods_status:a}}),r({type:"productList/getList",payload:{page:1}}),r({type:"productList/productSta"})},t.getList=function(e){var a=t.props.dispatch;a({type:"productList/getList",payload:e})},t.onSearch=function(e){var a=t.props.dispatch;a({type:"productList/onSearch",payload:e}),a({type:"productList/getList",payload:e})},t.changeProductStatus=function(e,a){$api.product.productHandle({goods_ids:e,goods_status:a}).then(function(){p["a"].success("\u5904\u7406\u6210\u529f\uff01"),t.table.clearSelectedRowKeys(),window.setTimeout(function(){t.getList(),t.props.dispatch({type:"productList/productSta"})},500)})},t.addProduct=function(){t.props.history.push("/product/addProduct/")},t.editProduct=function(e){t.props.history.push("/product/addProduct/?id=".concat(e))},t.copyProduct=function(e){t.props.history.push("/product/addProduct/?id=".concat(e,"&copy=",!0))},t.deleteProducts=function(e,a){d["a"].confirm({title:a?"\u786e\u8ba4\u5220\u9664\u6240\u9009\u5546\u54c1\u4e48?":"\u786e\u8ba4\u5220\u9664\u8be5\u5546\u54c1\u4e48?",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){$api.product.productDelete({goods_ids:e}).then(function(){p["a"].success("\u5220\u9664\u6210\u529f"),t.getList(),t.props.dispatch({type:"productList/productSta"}),a&&t.table.clearSelectedRowKeys()})}})},t.mutipulClick=function(e,a){switch(e){case"putaway":t.changeProductStatus(a,I.UPPER_SHELF);break;case"outOfStock":t.changeProductStatus(a,I.LOWER_SHELF);break;case"del":t.deleteProducts(a,!0);break}},t}return h()(a,[{key:"componentDidMount",value:function(){var t=this;$api.supplier.supplierSelectData().then(function(e){t.setState({supplierList:e.data||[]})}),$api.category.categoryList().then(function(e){t.setState({categoryList:e.data.item||[]})})}},{key:"getTabs",value:function(){var t=this.props.productList.tabsNum,e=s()(F);return t&&(e=e.map(function(e){var a=c()({},e);return t[a.value]&&(a.title="".concat(a.title,"(").concat(t[a.value],")")),a})),e}},{key:"render",value:function(){var t=this,e=this.getList,a=this.onSearch,r=this.props,o=r.productList,i=r.loading,n=o.goods_status,c=o.list,u=o.pagination,s=o.query,d=[{icon:"plus",name:"\u65b0\u589e\u5546\u54c1",type:"primary",handleClick:this.addProduct,permission:x("addProduct")}].filter(function(t){return t.permission});return k.a.createElement(b["x"],{inner:!0},k.a.createElement(b["E"],{defaultActiveKey:n,tabs:this.getTabs(),onChange:this.tabsChange,btns:d}),k.a.createElement(w["a"],{onRef:function(e){return t.table=e},loading:i.effects["productList/getList"],tableProps:{rowKey:"goods_id"},getList:e,onSearch:a,dataSource:c,mutipulBtns:N,mutipulClick:this.mutipulClick,pagination:u,columns:A.call(this),searchFields:T.call(this),searchProp:{search:s}}))}}]),a}(S["PureComponent"]),o=i))||o);e["default"]=U}}]);