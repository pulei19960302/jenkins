(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[68],{"5GmW":function(e,t,n){"use strict";n.r(t);var a,r,i,o=n("jehZ"),l=n.n(o),c=n("2Taf"),s=n.n(c),u=n("vZ4D"),d=n.n(u),m=n("MhPg"),p=n.n(m),f=n("l4Ni"),h=n.n(f),v=n("ujKo"),g=n.n(v),y=(n("2qtc"),n("kLXV")),_=n("q1tI"),b=n.n(_),E=n("MuoO"),S=n("Kvkj"),L=(n("/zsF"),n("PArb")),k=(n("+BJd"),n("mr32")),w=[{key:"attr",placeholder:"\u89c4\u683c\u540d\u79f0"}],C=function(){var e=this;return[{title:"\u5e8f\u53f7",render:function(e,t,n){return"".concat(n+1)}},{title:"\u89c4\u683c\u540d\u79f0",width:200,dataIndex:"name",render:function(e){return b.a.createElement(S["r"],{text:e,maxLine:"1"})}},{title:"\u89c4\u683c\u503c",dataIndex:"values",width:300,render:function(e){return b.a.createElement("div",null,e.map(function(e){return b.a.createElement(k["a"],{key:e.attr_value_id,color:"cyan"},e.attr_item_value)}))}},{title:"\u4fee\u6539\u65f6\u95f4",dataIndex:"updated_at"},{title:"\u64cd\u4f5c",render:function(t,n){return b.a.createElement("div",null,$api.specs.editSpecs.permission()&&b.a.createElement("a",{onClick:function(){e.editNormsModal(n)}},"\u7f16\u8f91"),b.a.createElement(L["a"],{type:"vertical"}),$api.specs.delSpecs.permission()&&b.a.createElement("a",{onClick:function(){e.handleDelNorms(n)}},"\u5220\u9664"))}}]},M=(n("5NDa"),n("5rEg")),x=n("p0pE"),P=n.n(x),j=(n("miYZ"),n("tsqr")),q=(n("y8nQ"),n("Vl3Y")),O=n("BkRI"),F=n.n(O),I=n("qIgq"),N=n.n(I),R=function(e){var t=e.handleSubmit,n=e.handleCancel,a=e.initForm,r=void 0===a?{values:[]}:a,i=Object(_["useState"])(!1),o=N()(i,2),c=o[0],s=o[1],u=Object(_["useState"])(F()(r.values)),d=N()(u,2),m=d[0],p=d[1],f=Object(_["useState"])(""),h=N()(f,2),v=h[0],g=h[1],E=Object(_["useState"])([]),S=N()(E,2),L=S[0],w=S[1],C=q["a"].useForm(),x=N()(C,1),O=x[0],I=function(){s(!0),O.validateFields().then(function(e){if(!m.length)return j["a"].warn("\u81f3\u5c11\u589e\u52a0\u4e00\u4e2a\u89c4\u683c\u503c."),void s(!1);var a={};r.attr_item_id?(console.log("\u7f16\u8f91"),a=P()({},r,e,{values:m,del_val:L.filter(function(e){return e.attr_value_id}).map(function(e){return e.attr_value_id}).join(",")}),Reflect.deleteProperty(a,"value"),console.log(a,"requestBody"),$api.specs.editSpecs(a,{success:!0}).then(function(e){n(),t(),s(!1)}).catch(function(e){s(!1)})):(console.log("\u65b0\u589e"),a=P()({},r,e,{attr_item_value:m.map(function(e){return e.attr_item_value}).join(",")}),Reflect.deleteProperty(a,"value"),console.log(a,"requestBody"),$api.specs.addSpecs(a,{success:!0}).then(function(e){n(),t(),s(!1)}).catch(function(e){s(!1)})),s(!1)}).catch(function(e){s(!1)})},R=function(e){var t=e&&e.target&&e.target.value.trim();if(t){var n=m.filter(function(e){return e.attr_item_value===t});n&&0===n.length&&m.push({attr_item_value:t}),p(m),g(t)}O.resetFields(["value"])},V=function(e){var t=m.filter(function(t){return t.attr_item_value!==e});p(t),w(L.concat(m.filter(function(t){return t.attr_item_value===e})))},D={title:r.attr_item_id?"\u7f16\u8f91\u89c4\u683c":"\u65b0\u589e\u89c4\u683c",visible:!0,width:580,maskClosable:!1,confirmLoading:c,destroyOnClose:!0,onOk:I,onCancel:n},$={labelCol:{span:6},wrapperCol:{span:14}};return b.a.createElement(y["a"],D,b.a.createElement(q["a"],l()({initialValues:r,form:O},$),b.a.createElement(q["a"].Item,{label:"\u89c4\u683c\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u683c\u540d\u79f0"}]},b.a.createElement(M["a"],{maxLength:30})),b.a.createElement(q["a"].Item,{label:"\u89c4\u683c\u503c",required:!0,name:"value"},b.a.createElement("div",null,m&&m.map(function(e){return b.a.createElement("div",{key:e.attr_item_value,style:{marginBottom:"8px",display:"inline-block"}},b.a.createElement(k["a"],{closable:!0,onClose:function(t){return V(e.attr_item_value)}}," ",e.attr_item_value," "))}),b.a.createElement("div",{style:{marginTop:"8px"}},b.a.createElement(M["a"],{maxLength:30,autoFocus:!!v,placeholder:"\u8bf7\u6309enter\u6dfb\u52a0",onPressEnter:R}))))))},V=R;function D(e){return function(){var t,n=g()(e);if($()){var a=g()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return h()(this,t)}}function $(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var B=y["a"].confirm,T=(a=Object(E["connect"])(function(e){var t=e.normsList,n=e.loading;return{normsList:t,loading:n}}),a((i=function(e){p()(n,e);var t=D(n);function n(){var e;s()(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),e.state={modalVisible:!1,normsModalProps:{}},e.handleDelNorms=function(t){var n=e.props.dispatch;B({title:"\u5220\u9664\u89c4\u683c",content:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u5f53\u524d\u89c4\u683c\uff1f",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){$api.specs.delSpecs({id:t.attr_item_id},{success:!0}).then(function(e){n({type:"normsList/getList",payload:{page:1}})})}})},e.handleSearch=function(t){var n=e.props.dispatch;n({type:"normsList/onSearch",payload:t}),n({type:"normsList/getList",payload:{page:1}})},e.toggleModal=function(){var t=e.state.modalVisible;e.setState({modalVisible:!t})},e.addNorms=function(){e.setState({normsModalProps:{handleSubmit:e.handleSearch,handleCancel:e.toggleModal}}),e.toggleModal()},e.editNormsModal=function(t){console.log(t,"row"),e.setState({normsModalProps:{handleSubmit:e.handleSearch,initForm:t,handleCancel:e.toggleModal}}),e.toggleModal()},e.getList=function(t){var n=e.props.dispatch;n({type:"normsList/getList",payload:t})},e}return d()(n,[{key:"render",value:function(){var e=this,t=this.getList,n=this.state,a=n.modalVisible,r=n.normsModalProps,i=this.props,o=i.normsList,c=i.loading,s=o.list,u=o.pagination,d=[{icon:"plus",name:"\u65b0\u589e\u89c4\u683c",type:"primary",handleClick:function(){return e.addNorms()},permission:$api.specs.addSpecs.permission()}].filter(function(e){return e.permission});return b.a.createElement(S["x"],{inner:!0},b.a.createElement(S["y"],{btns:d}),b.a.createElement(S["i"],{tableProps:{rowKey:function(e,t){return t}},loading:c.effects["normsList/getList"],onSearch:this.handleSearch,dataSource:s,columns:C.call(this),searchFields:w,pagination:u,getList:t}),a&&b.a.createElement(V,l()({},r,{handleCancel:this.toggleModal})))}}]),n}(_["PureComponent"]),r=i))||r);t["default"]=T}}]);