(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[85],{"3QPa":function(e,t,n){e.exports={editor:"editor___3qgQO",spin:"spin___2FHTc"}},"S/Tz":function(e,t,n){"use strict";n.r(t);n("2qtc");var a,i,r,l=n("kLXV"),o=n("2Taf"),s=n.n(o),d=n("vZ4D"),c=n.n(d),u=n("MhPg"),g=n.n(u),h=n("l4Ni"),f=n.n(h),m=n("ujKo"),p=n.n(m),v=n("MuoO"),E=n("q1tI"),b=n.n(E),k=n("Kvkj"),y=(n("/zsF"),n("PArb")),A=n("Gm+L"),L=function(){var e=this;return[{title:"\u534f\u8baeID",dataIndex:"id"},{title:"\u534f\u8bae\u540d\u79f0",dataIndex:"title"},{title:"\u72b6\u6001",dataIndex:"status",render:function(t,n){var a=n.id,i=void 0===a?"":a;return b.a.createElement(k["m"],{values:[A["a"].ENABLED,A["a"].DISABLED],texts:["\u542f\u7528","\u7981\u7528"],value:t,className:"mr10",onChange:function(t){e.handleSwitchStatus(t,i)},disabled:!Object(A["e"])("switchAgreeStatus")})}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(t,n){var a=n.id,i=void 0===a?"":a;return b.a.createElement("div",null,Object(A["e"])("updateAgreement")&&b.a.createElement("span",null,b.a.createElement("a",{onClick:function(){e.handleEdit(i)}},"\u7f16\u8f91"),b.a.createElement(y["a"],{type:"vertical"})),Object(A["e"])("deleteAgreement")&&b.a.createElement("a",{onClick:function(){e.handleDelete(i)}},"\u5220\u9664"))}}]},S=(n("bbsP"),n("/wGt")),w=(n("T2oS"),n("W9HT")),C=n("jehZ"),D=n.n(C),O=(n("sRBo"),n("kaz8")),I=(n("5NDa"),n("5rEg")),_=n("p0pE"),j=n.n(_),x=n("Y/ft"),M=n.n(x),P=n("WsrF"),R=(n("XlDN"),n("yEr3")),F=n.n(R),N=n("3QPa"),q=n.n(N);function T(e){return function(){var t,n=p()(e);if(B()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function B(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $,G,V,z={labelCol:{span:2},wrapperCol:{span:16}},H={controls:["undo","redo","split","indent","bold","italic","underline","strike-through","remove-styles","split","list-ul","list-ol","blockquote","link","hr","media","clear"]},Q=[{label:"\u5c0f\u7a0b\u5e8f",value:"mini"},{label:"\u516c\u4f17\u53f7",value:"wechat"}],W=[{label:"\u767b\u5f55\u6ce8\u518c\u9875",value:"1"},{label:"\u8d26\u53f7\u8bbe\u7f6e\u9875",value:"2"}],J=(a=P["a"].create(),a((r=function(e){g()(n,e);var t=T(n);function n(e){var a;return s()(this,n),a=t.call(this,e),a.getDetails=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&(a.toggleLoading(),$api.system.getAgreementInfo({id:e}).then(function(e){var t=e||{},n=t.data,i=void 0===n?{}:n,r=i.data,l=void 0===r?{}:r,o=l.title,s=void 0===o?"":o,d=l.data,c=void 0===d?"":d,u=l.show_channel,g=void 0===u?"":u,h=l.show_page,f=void 0===h?"":h,m=l.status,p=void 0===m?"":m;a.toggleLoading(),a.props.form.setFieldsValue({title:s,data:F.a.createEditorState(c),show_channel:g&&g.split(","),show_page:f&&f.split(","),status:p})}).catch(function(e){a.toggleLoading()}))},a.toggleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleCheckEditor=function(e,t,n){if(t&&!t.isEmpty())return n();n("\u8bf7\u8f93\u5165")},a.handleChangeEditor=function(e){var t=a.props.form;t.setFieldsValue({data:e})},a.handleClose=function(){var e=a.props.onClose;e&&e()},a.handleOk=function(){var e=a.props,t=e.form,n=e.onOk,i=e.id,r=void 0===i?"":i;t.validateFields(function(e,t){if(e)return null;var i=t.data,l=void 0===i?"":i,o=M()(t,["data"]),s=j()({data:l&&l.toHTML()},o);a.toggleLoading();var d=r?$api.system.updateAgreement(j()({id:r},s)):$api.system.addAgreement(j()({},s));d.then(function(e){a.toggleLoading(),n&&n()}).catch(function(e){a.toggleLoading()})})},a.state={loading:!1,details:""},a}return c()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.visible,n=e.visible,a=e.id,i=void 0===a?"":a;!t&&n&&this.getDetails(i)}},{key:"renderForm",value:function(){var e=this.props.form.getFieldDecorator;return b.a.createElement(P["a"],D()({},z,{labelAlign:"left"}),b.a.createElement(P["a"].Item,{label:"\u534f\u8bae\u540d\u79f0"},e("title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u534f\u8bae\u540d\u79f0"}]})(b.a.createElement(I["a"],{placeholder:"\u8bf7\u8f93\u5165\u534f\u8bae\u540d\u79f0",maxLength:20}))),b.a.createElement(P["a"].Item,{label:"\u534f\u8bae\u5185\u5bb9"},b.a.createElement("div",{className:q.a.editor},e("data",{valuePropName:"editorState",rules:[{required:!0,validator:this.handleCheckEditor}]})(b.a.createElement(k["k"],{onChange:this.handleChangeEditor,editorProps:H})))),b.a.createElement(P["a"].Item,{label:"\u663e\u793a\u7ec8\u7aef"},e("show_channel",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u663e\u793a\u7ec8\u7aef"}]})(b.a.createElement(O["a"].Group,{options:Q}))),b.a.createElement(P["a"].Item,{label:"\u663e\u793a\u9875\u9762"},e("show_page",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u663e\u793a\u9875\u9762"}]})(b.a.createElement(O["a"].Group,{options:W}))),b.a.createElement(P["a"].Item,{label:"\u72b6\u6001"},e("status",{initialValue:A["a"].DISABLED,rules:[{required:!0}]})(b.a.createElement(k["m"],null))))}},{key:"render",value:function(){var e=this.state.loading,t=this.props,n=t.visible,a=t.id,i=a?"\u7f16\u8f91\u534f\u8bae":"\u65b0\u589e\u534f\u8bae";return b.a.createElement("div",null,b.a.createElement(S["a"],{title:i,visible:n,placement:"right",width:"1000",headerStyle:{background:"#f5f5f5"},maskClosable:!1,destroyOnClose:!0,onClose:this.handleClose},e&&b.a.createElement("div",{className:q.a.spin},b.a.createElement(w["a"],null)),this.renderForm(),b.a.createElement(k["j"],{onOk:this.handleOk,onCancel:this.handleClose})))}}]),n}(E["PureComponent"]),i=r))||i),K=J;function X(e){return function(){var t,n=p()(e);if(Z()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return f()(this,t)}}function Z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var U=($=Object(v["connect"])(function(e){var t=e.agreement,n=e.loading;return{agreement:t,loading:n}}),$((V=function(e){g()(n,e);var t=X(n);function n(e){var a;return s()(this,n),a=t.call(this,e),a.toggleAddAgreeModal=function(){a.setState(function(e){return{addAgreeModal:!e.addAgreeModal,id:""}})},a.toggleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.getList=function(e){var t=a.props.dispatch;t({type:"agreement/getList",payload:e})},a.handleSwitchStatus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a.toggleLoading(),$api.system.switchStatus({ids:t,status:e}).then(function(e){a.getList(),a.toggleLoading()}).catch(function(e){a.toggleLoading()})},a.handleDelete=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";l["a"].confirm({title:"\u786e\u8ba4\u5220\u9664\u6240\u9009\u534f\u8bae\u4e48?",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){$api.system.deleteAgreement({ids:e}).then(function(e){a.getList()})}})},a.handleEdit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.setState({id:e,addAgreeModal:!0})},a.mutipulClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];switch(e){case"enabled":a.handleSwitchStatus(A["a"].ENABLED,t);break;case"disabled":a.handleSwitchStatus(A["a"].DISABLED,t);break;case"delete":a.handleDelete(t);break}},a.state={loading:!1,addAgreeModal:!1,id:""},a}return c()(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.addAgreeModal,a=t.id,i=this.props,r=i.agreement,l=i.loading,o=r.list,s=void 0===o?[]:o,d=r.pagination,c=[{icon:"plus",type:"primary",name:"\u6dfb\u52a0\u534f\u8bae",handleClick:this.toggleAddAgreeModal,permission:Object(A["e"])("addAgreement")}].filter(function(e){return e.permission}),u=l.effects["agreement/getList"]||this.state.loading,g=[{name:"\u6279\u91cf\u542f\u7528",key:"enabled",permission:Object(A["e"])("switchAgreeStatus")},{name:"\u6279\u91cf\u505c\u7528",key:"disabled",permission:Object(A["e"])("switchAgreeStatus")},{name:"\u6279\u91cf\u5220\u9664",key:"delete",permission:Object(A["e"])("deleteAgreement")}].filter(function(e){return e.permission});return b.a.createElement(k["x"],{inner:!0},b.a.createElement(k["y"],{btns:c}),b.a.createElement(k["i"],{dataSource:s,getList:this.getList,pagination:d,loading:u,mutipulBtns:g,mutipulClick:this.mutipulClick,columns:L.call(this)}),b.a.createElement(K,{id:a,visible:n,onOk:function(){e.toggleAddAgreeModal(),e.getList()},onClose:this.toggleAddAgreeModal}))}}]),n}(E["PureComponent"]),G=V))||G);t["default"]=U}}]);