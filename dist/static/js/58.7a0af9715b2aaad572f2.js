webpackJsonp([58],{"5R81":function(e,t){},cnQn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("4YfN"),n=a.n(r),o=a("aA9S"),l=a.n(o),i=a("lC5x"),s=a.n(i),c=a("J0Oq"),u=a.n(c),p=a("IHPB"),d=a.n(p),f=a("czH5"),m={name:"financialDetails",data:function(){return{loading:!1,dialogVisible:!1,current:1,pageSize:30,count:0,query:{},exportOptions:[],tableData:[],multipleSelection:[],value2:"",searchOPtions:[{type:"input",key:"uid",placeholder:"用户ID"},{type:"input",key:"username",placeholder:"用户名"},{type:"input",key:"admin_username",placeholder:"操作人"},{type:"input",key:"order_no",placeholder:"来源"},{type:"select",key:"type",placeholder:"收支类型",options:[].concat(d()(f.b.PAYMENT_TYPES))},{type:"datetimerange",key:"start_at-end_at",placeholder:"创建时间"}],value:"",form:{uid:"",type:"",money:"",remark:"",password:""},rules:{uid:[{required:!0,message:"请输入",trigger:"change"}],type:[{required:!0,message:"请选择",trigger:"change"}],money:[{required:!0,message:"请输入",trigger:"change"}],remark:[{required:!0,message:"请选择",trigger:"change"}],password:[{required:!0,message:"请选择",trigger:"change"}],sort:[{required:!0,message:"请输入",trigger:"change"}]},options4:[],options5:[],list:[],total_actual_money:""}},created:function(){this.getData(),this.balanceRecordType()},methods:{balanceRecordType:function(){var e=this;return u()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.finance.balanceRecordType();case 2:a=t.sent,r=a.data,e.options5=r;case 5:case"end":return t.stop()}},t,e)}))()},updatemoney:function(){var e=this;return u()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.form.validate(function(){var t=u()(s.a.mark(function t(a){var r,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.prev=1,r=l()({},e.form),t.next=5,e.$api.finance.updatemoney(r);case 5:n=t.sent,0==n.code&&(e.dialogVisible=!1,e.$refs.form.resetFields(),e.getData()),t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(1),new Error(t.t0);case 13:case"end":return t.stop()}},t,e,[[1,10]])}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()},remoteMethod:function(e){var t=this;return u()(s.a.mark(function a(){var r,n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(""===e){a.next=10;break}return t.loading=!0,a.next=4,t.$api.finance.balanceRecordUser({name:e});case 4:r=a.sent,n=r.data,t.list=n.map(function(e){return{value:e.id,label:e.name}}),setTimeout(function(){t.loading=!1,t.options4=t.list.filter(function(t){return String(t.value).indexOf(e)>-1})},200),a.next=11;break;case 10:t.options4=[];case 11:case"end":return a.stop()}},a,t)}))()},handleSelectionChange:function(e){this.multipleSelection=e},handlePageChange:function(e){this.current=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},handelSearch:function(e,t){var a=this;({search:function(){a.query=n()({},t),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[e]()},getData:function(){var e=this;return u()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.$api.finance.balanceRecordList(n()({},e.query,{pageSize:e.pageSize,page:e.current}));case 4:a=t.sent,r=a.data,e.tableData=r.items,e.count=r.count,e.total_actual_money=r.total_money||0,e.exportOptions=r.fields||[],e.loading=!1,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e.loading=!1;case 16:case"end":return t.stop()}},t,e,[[0,13]])}))()},handelClick:function(){}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"br4 financialDetails"},[a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}},[a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("加扣款")])],1),e._v(" "),a("div",{staticStyle:{padding:"0 16px 16px 16px"}},[a("div",{staticClass:"summaryBar"},[a("i",{staticClass:"el-icon-tickets mr6 fs18 fcblue vamiddle"}),e._v("\n                符合搜索条件的数据："),a("span",{staticClass:"fcorange mr24"},[e._v(e._s(e.count))]),e._v("\n                总价："),a("span",{staticClass:"fcorange"},[e._v(e._s(e.total_actual_money))])]),e._v(" "),[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","highlight-current-row":!0,border:"",data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"uid",label:"用户ID"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",prop:"username","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"收支类型",prop:"type_name","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{width:"160",label:"来源",prop:"order_no","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{align:"right",label:"资金（元）",prop:"money","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{align:"right",label:"交易后余额（元）",prop:"balance","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"created_at","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",prop:"admin_username","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                            "+e._s(e._f("validVal")(t.row.admin_username))+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remark","show-overflow-tooltip":""}})],1)]],2),e._v(" "),a("Pagination",{attrs:{"page-choose":[10,30,50],current:e.current,pageSize:e.pageSize,count:e.count},on:{pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange}}),e._v(" "),a("el-dialog",{attrs:{title:"加扣款",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户名：",prop:"uid"}},[a("el-select",{staticStyle:{width:"70%"},attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入用户ID搜索","remote-method":e.remoteMethod,loading:e.loading},model:{value:e.form.uid,callback:function(t){e.$set(e.form,"uid",t)},expression:"form.uid"}},e._l(e.options4,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"收支类型：",prop:"type"}},[a("el-select",{staticStyle:{width:"70%"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.options5,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"资金：",prop:"money"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{autocomplete:"off"},model:{value:e.form.money,callback:function(t){e.$set(e.form,"money",t)},expression:"form.money"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{type:"textarea",rows:2,autocomplete:"off"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),a("AutoInputFix"),e._v(" "),a("el-form-item",{attrs:{label:"密码：",prop:"password"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{type:"password",autocomplete:"off"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1,e.isEdit=!1,e.resetForm()}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatemoney()}}},[e._v("\n                    确定\n                ")])],1)],1)],1)},staticRenderFns:[]};var g=a("C7Lr")(m,h,!1,function(e){a("5R81")},"data-v-4ad4376c",null);t.default=g.exports}});