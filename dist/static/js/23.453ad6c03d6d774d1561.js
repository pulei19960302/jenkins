webpackJsonp([23,48],{FDA2:function(e,t){},Fh8j:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"EvaluateDetails",props:{detailsData:[Object]},components:{},data:function(){return{query:{},current:1,pageSize:10,count:4,rateValue:4,ruleForm:{name:"",email:"",content:""},rules:{content:[{required:!0,message:"请填写回复内容",trigger:"blur"}]}}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{submitForm:function(e){this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;alert("submit!")})},resetForm:function(e){this.$refs[e].resetFields()},getData:function(){},handlePageChange:function(e){this.current=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},handleOperate:function(e){var t="del"===e?"删除":"隐藏";this.$message({type:"success",message:t+"成功!"})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"evaluate-details"},[a("div",{staticClass:"left"},[a("div",{staticClass:"header"},[a("img",{staticClass:"icon",attrs:{src:e.detailsData.avatar}}),e._v(" "),a("p",[e._v(e._s(e._f("validVal")(e.detailsData.nickname)))])]),e._v(" "),a("div",{staticClass:"left-content"},[a("p",[a("span",[e._v("商品：")]),e._v(e._s(e._f("validVal")(e.detailsData.title)))]),e._v(" "),a("p",[a("span",[e._v("购买：")]),e._v(e._s(e._f("validVal")(e.detailsData.sku_properties_name)))]),e._v(" "),a("p",[a("span",[e._v("评价：")]),e._v(" "),a("el-rate",{staticStyle:{display:"inline-block"},attrs:{"show-text":"",disabled:"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.detailsData.score,callback:function(t){e.$set(e.detailsData,"score",t)},expression:"detailsData.score"}})],1),e._v(" "),a("p",[a("span",[e._v("日期：")]),e._v(" "+e._s(e._f("validDateTime")(e.detailsData.created_at)))])])]),e._v(" "),a("div",{staticClass:"center"},[e._m(0),e._v(" "),a("div",{staticClass:"center-content"},[e._v("\n            "+e._s(e._f("validVal")(e.detailsData.content))+"\n        ")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pviews"},[t("b",[this._v("评价内容")])])}]};var r=a("C7Lr")(i,n,!1,function(e){a("FDA2")},"data-v-6814ec38",null);t.default=r.exports},GXuu:function(e,t){},wsQz:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("aA9S"),n=a.n(i),r=a("lC5x"),s=a.n(r),o=a("rVsN"),l=a.n(o),c=a("J0Oq"),u=a.n(c),d=a("4YfN"),p=a.n(d),v=a("48sp"),m=a("FFUX"),f=a("8Rg7"),h=a("Fh8j"),g={name:"EvaluateProduct",mixins:[f.a],components:{EvaluateDetails:h.default},data:function(){return{visible:!1,imgSrc:"",pageOptions:[{value:"del",label:"删除",type:"danger"}],rghtPopupVisible:!1,detailsData:{},loading:!1,searchOPtions:[{type:"input",key:"username",placeholder:"用户昵称"},{type:"input",key:"title",placeholder:"商品名称/商品货号"},{type:"select",key:"status",placeholder:"状态",options:[{value:"0",label:"隐藏"},{value:"10",label:"显示"}]},{type:"select",key:"from",placeholder:"来源",options:[{value:"1",label:"用户评论"},{value:"2",label:"后台添加"}]}],query:{},current:1,pageSize:10,count:0,tableData:[],multipleSelection:[],form:{nickname:"",job:"",score:5,content:"",imgs:[],video:[],goods_id:"",is_anonymity:0},dialogVisible:!1,avatar:[],avatarDetail:[],imgs:[],videos:[],goods:[],id:null}},computed:p()({},Object(v.e)("user",["button_permissions"])),activated:function(){this.getData(),this.getGoodsList()},methods:{handlePreview:function(e){this.visible=!0,this.imgSrc=e},handleAdd:function(){for(var e in this.dialogVisible=!0,this.id=null,this.form)this.form[e]="";this.form.is_anonymity=0,this.form.score=5,this.imgs=[],this.avatarDetail=[{name:"",url:""}],this.avatar=[],this.videos=[]},handleEdit:function(e){for(var t in this.form)this.form[t]=e[t];this.id=e.id,this.imgs=e.imgs?e.imgs.slice(-5):[],this.videos=e.video?e.video.slice(-1):[],this.form.goods_id=Number(e.goods_id),this.form.is_anonymity=Number(e.is_anonymity),this.form.created_time=1e3*e.created_time,this.avatar=[e.avatar],this.avatarDetail=[{name:"avatar",url:e.avatar}],this.dialogVisible=!0},getGoodsList:function(){var e=this;return u()(s.a.mark(function t(){var a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.common.getGoodsSelect();case 3:return a=t.sent,i=a.data,e.goods=i.list.items,t.abrupt("return",l.a.resolve(!0));case 9:throw t.prev=9,t.t0=t.catch(0),new Error(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},getsuccessUpload:function(e,t){switch(t){case"avatar":this.avatar=e;break;case"imgs":this.imgs=e;break;case"video":this.videos=e}},addEvaluate:function(){var e=this;return u()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.form.validate(function(){var t=u()(s.a.mark(function t(a){var i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=17;break}return t.prev=1,(i=n()({},e.form)).created_time=i.created_time/1e3,i.avatar=e.avatar[0],i.video=e.videos.slice(-1),i.imgs=e.imgs.slice(-5),e.id&&(i.id=e.id),t.next=10,e.$api.product.addEvaluate(i);case 10:e.dialogVisible=!1,e.getData(),t.next=17;break;case 14:throw t.prev=14,t.t0=t.catch(1),new Error(t.t0);case 17:case"end":return t.stop()}},t,e,[[1,14]])}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,e)}))()},changeStatus:function(e){var t=this,a=e.status,i=e.id;return u()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.product.evaluateSetStatus({status:a,ids:i});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.tableData.map(function(e){e.id===i&&t.$set(e,"status",10==a?0:10)});case 8:case"end":return e.stop()}},e,t,[[0,5]])}))()},lookDetails:function(e){this.detailsData=p()({},e),this.rghtPopupVisible=!0},handelSearch:function(e,t){var a=this;({search:function(){a.query=p()({},t),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[e]()},handlePageChange:function(e){this.current=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},getData:function(){var e=this;return u()(s.a.mark(function t(){var a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.$api.product.evaluateList(p()({},e.query,{page:e.current,pageSize:e.pageSize}));case 4:a=t.sent,i=a.data,e.loading=!1,i.list.forEach(function(e){e.score=Number(e.score)}),e.tableData=i.list,e.count=Number(i.num),t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),e.loading=!1,new Error(t.t0);case 16:case"end":return t.stop()}},t,e,[[0,12]])}))()},handleSelectionChange:function(e){this.multipleSelection=e.map(function(e){return e.id})},handleOpreate:function(){this.multipleSelection.length<1?this.$message.error("请至少选择一条反馈"):this.handleDel(this.multipleSelection)},handleDel:function(e){var t=this;this.$confirm("确认删除选中反馈？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(s.a.mark(function a(){var i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=void 0,i=m.e.isArray(e)?e.join(","):e,a.prev=2,a.next=5,t.$api.product.evaluateDel({ids:i});case 5:t.getData(),a.next=11;break;case 8:throw a.prev=8,a.t0=a.catch(2),new Error(a.t0);case 11:case"end":return a.stop()}},a,t,[[2,8]])})))}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remove-product"},[a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.evaluate.add],expression:"[$api.product.evaluate.add]"}],attrs:{type:"primary",plain:"",size:"small"},on:{click:e.handleAdd}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"common-table-wrapper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","highlight-current-row":!0,border:"",data:e.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#fafafa",border:"none",borderBottom:"1px solid #e8e8e8"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{width:"60",align:"center",prop:"id",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"nickname",label:"用户昵称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e._f("validVal")(t.row.nickname))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"title",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"goods_id",label:"商品ID"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"score",label:"评价"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-rate",{attrs:{"show-score":"",disabled:"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.row.score,callback:function(a){e.$set(t.row,"score",a)},expression:"scope.row.score"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"is_anonymity",label:"是否为匿名评价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s("0"==t.row.is_anonymity?"否":"是")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"created_at",width:"140",label:"评论时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e._f("validDateTime")(t.row.created_at))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",label:"来源"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(2==t.row.status?"后台添加":"用户")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",width:"100",label:"是否显示"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:!e.button_permissions.includes(e.$api.product.evaluate.add),"active-value":"10","inactive-value":"0"},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.evaluate.add],expression:"[$api.product.evaluate.add]"}],attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("\n                    编辑\n                ")]),e._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.evaluate.del],expression:"[$api.product.evaluate.del]"}],attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleDel(t.row.id)}}},[e._v("\n                    删除\n                ")])]}}])})],1)],1),e._v(" "),a("Pagination",{attrs:{options:e.pageOptions,current:e.current,pageSize:e.pageSize,count:e.count},on:{opreateCBK:e.handleOpreate,pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange}}),e._v(" "),a("RightSidePopup",{attrs:{visible:e.rghtPopupVisible,width:"40%"},on:{"update:visible":function(t){e.rghtPopupVisible=t}}},[a("EvaluateDetails",{attrs:{detailsData:e.detailsData}})],1),e._v(" "),a("el-dialog",{attrs:{top:"4vh",title:"添加商品评论",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户昵称：",prop:"nickname",rules:[e.simpleRule]}},[a("el-input",{staticStyle:{width:"240px"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像："}},[a("FileUpload",{attrs:{fileList:e.avatarDetail,isOnly:"",width:"80px",height:"80px"},on:{successUploadCBK:function(t){return e.getsuccessUpload(t,"avatar")}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户评分：",prop:"score",rules:[e.simpleRule]}},[a("el-rate",{staticStyle:{"margin-top":"6px"},attrs:{"show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"评价内容：",prop:"content",rules:[e.simpleRule]}},[a("el-input",{staticStyle:{width:"240px"},attrs:{rows:4,type:"textarea",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"评价时间：",prop:"created_time",rules:[e.simpleRule]}},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{"value-format":"timestamp",size:"mini",type:"datetime"},model:{value:e.form.created_time,callback:function(t){e.$set(e.form,"created_time",t)},expression:"form.created_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"图片："}},[e._l(e.imgs,function(t,i){return a("li",{key:i,staticClass:"imgs",style:{backgroundImage:"url("+t+")"},on:{click:function(a){return e.handlePreview(t)}}})}),e._v(" "),a("FileUpload",{attrs:{width:"100px",height:"100px",limit:5,isBotton:""},on:{successUploadCBK:function(t){return e.getsuccessUpload(t,"imgs")}}})],2),e._v(" "),a("el-form-item",{attrs:{label:"视频："}},[e._l(e.videos,function(t,i){return a("li",{key:i,staticClass:"videos"},[t?a("video",{attrs:{src:t,controls:"",preload:""}}):e._e()])}),e._v(" "),a("FileUpload",{attrs:{width:"100px",height:"100px",limit:2,isVideo:"",isBotton:""},on:{successUploadCBK:function(t){return e.getsuccessUpload(t,"video")}}})],2),e._v(" "),a("el-form-item",{attrs:{label:"是否匿名：",prop:"is_anonymity"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.is_anonymity,callback:function(t){e.$set(e.form,"is_anonymity",t)},expression:"form.is_anonymity"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"添加商品：",prop:"goods_id",rules:[e.simpleRule]}},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择商品",filterable:"",clearable:""},model:{value:e.form.goods_id,callback:function(t){e.$set(e.form,"goods_id",t)},expression:"form.goods_id"}},e._l(e.goods,function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addEvaluate}},[e._v("\n                发 布\n            ")])],1)],1),e._v(" "),a("PreviewImg",{attrs:{visible:e.visible,imgSrc:e.imgSrc},on:{"update:visible":function(t){e.visible=t}}})],1)},staticRenderFns:[]};var b=a("C7Lr")(g,_,!1,function(e){a("GXuu")},"data-v-cc35e60e",null);t.default=b.exports}});