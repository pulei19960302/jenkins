webpackJsonp([65],{"0xjU":function(t,e){},tgsp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("aA9S"),n=a.n(i),r=a("lC5x"),s=a.n(r),l=a("J0Oq"),o=a.n(l),u=a("4YfN"),c=a.n(u),p={name:"TypesList",props:{id:{}},data:function(){return{searchOPtions:[{type:"input",key:"name",placeholder:"属性名称"}],options:[{value:"del",label:"删除"}],query:{},current:1,pageSize:10,count:0,tableData:[],columnSelect:[],addType:"",dialogVisible:!1,submit:{is_color:0,name:"",sort:"",attr_value:"",color:""},param_id:this.$route.params.id,rules:{name:[{required:!0,message:"必填项",trigger:"change"}],sort:[{required:!0,message:"必填项",trigger:"change"}]}}},watch:{id:function(t){this.reset()}},methods:{reset:function(){this.query={},this.pageSize=10,this.current=1,this.getData()},handelSearch:function(t,e){var a=this;({search:function(){a.query=c()({},e),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[t]()},getData:function(){var t=this;return o()(s.a.mark(function e(){var a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.product.attrList(c()({},t.query,{pageSize:t.pageSize,page:t.current,type_id:t.id}));case 3:a=e.sent,i=a.data,t.tableData=i.items,t.count=i.count,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,t,[[0,9]])}))()},handlePageChange:function(t){this.current=t,this.getData()},handleSizeChange:function(t){this.pageSize=t,this.getData()},handleSelectionChange:function(t){var e=[];t.length<1?this.columnSelect=[]:(t.map(function(t){e.push(t.id)}),this.columnSelect=e)},jumpTo:function(t,e,a,i){this.$emit("showValueList",i)},handleDel:function(t){var e=this;this.$confirm("确认删除选中商品属性？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.del(t)}).catch(function(){})},del:function(t){var e=this;if("many"==t){if(this.columnSelect.length<1)return void this.$message({message:"请至少选择一条商品属性",type:"error"});this.$api.product.attrDelall({ids:this.columnSelect.join(",")}).then(function(){e.getData()})}else this.$api.product.attrDel({id:t}).then(function(){e.getData()})},open:function(t,e){if(this.dialogVisible=!0,this.addType=t,"edit"===t)this.submit.id=e.id,this.submit.name=e.name,this.submit.sort=e.sort,this.submit.attr_value=e.values,this.submit.is_color=e.is_color;else for(var a in this.submit)this.submit[a]="",this.submit.is_color=0},add:function(){var t,e=this,a=n()({},this.submit);a.type_id=this.id,this.$refs.submit.validate((t=o()(s.a.mark(function t(i){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=16;break}if(t.prev=1,"add"!=e.addType){t.next=7;break}return t.next=5,e.$api.product.attrAdd(a);case 5:t.next=9;break;case 7:return t.next=9,e.$api.product.attrEdit(a);case 9:for(n in e.submit)e.submit[n]="",e.submit.is_color=0;e.dialogVisible=!1,e.getData(),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(1);case 16:case"end":return t.stop()}},t,e,[[1,14]])})),function(e){return t.apply(this,arguments)}))}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"types-list types-list-container"},[a("div",{staticStyle:{"margin-bottom":"10px"}}),t._v(" "),a("Search",{attrs:{searchOPtions:t.searchOPtions},on:{searchCallback:t.handelSearch}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.open("add")}}},[t._v("添 加")])],1),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"编号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"name",label:"属性名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"values",label:"可选值列表"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sort",label:"排序"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return t.open("edit",e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){return t.jumpTo("TypeValusList","ValusList",t.param_id,e.row.id)}}},[t._v("编辑属性值")]),t._v(" "),a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){return t.handleDel(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("Pagination",{attrs:{current:t.current,count:t.count,pageSize:t.pageSize},on:{opreateCBK:function(e){return t.handleDel("many")},pageChangeCBK:t.handlePageChange,sizeChangeCBK:t.handleSizeChange}}),t._v(" "),a("el-dialog",{attrs:{title:"添加商品属性",visible:t.dialogVisible,modal:!1,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"submit",attrs:{model:t.submit,rules:t.rules,"label-width":"150px","label-position":"right"}},[a("el-form-item",{attrs:{label:"属性名称：",prop:"name"}},[a("el-input",{model:{value:t.submit.name,callback:function(e){t.$set(t.submit,"name",e)},expression:"submit.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序：",prop:"sort"}},[a("el-input",{model:{value:t.submit.sort,callback:function(e){t.$set(t.submit,"sort",e)},expression:"submit.sort"}})],1),t._v(" "),"add"===t.addType?a("div",[a("el-form-item",{attrs:{label:"属性值：",prop:"attr_value"}},[a("el-input",{model:{value:t.submit.attr_value,callback:function(e){t.$set(t.submit,"attr_value",e)},expression:"submit.attr_value"}}),t._v(" "),a("p",{staticClass:"tips"},[t._v("多个属性请用 , 分割")])],1),t._v(" "),a("el-form-item",{attrs:{label:"是否设置单独sku图：",prop:"is_color"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.submit.is_color,callback:function(e){t.$set(t.submit,"is_color",e)},expression:"submit.is_color"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"色值："}},[a("el-input",{model:{value:t.submit.color,callback:function(e){t.$set(t.submit,"color",e)},expression:"submit.color"}}),t._v(" "),a("p",{staticClass:"tips"},[t._v("多个颜色请用 , 分割")])],1)],1):t._e()],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("\n                确定\n            ")])],1)],1)],1)},staticRenderFns:[]};var m=a("C7Lr")(p,d,!1,function(t){a("0xjU")},null,null);e.default=m.exports}});