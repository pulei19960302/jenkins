webpackJsonp([18],{"3UqK":function(e,t,a){"use strict";var r={name:"card-table-td",props:{width:{type:Number,required:!0}}},s={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"cardTable-cardGrid",style:"flex: "+this.width},[this._t("default")],2)},staticRenderFns:[]};var i=a("C7Lr")(r,s,!1,function(e){a("WyXV")},"data-v-42e7bf2a",null);t.a=i.exports},FkPv:function(e,t,a){"use strict";var r={name:"card-table",props:{loading:{type:Boolean,required:!0},cardListData:{type:Array,required:!0},rowKey:{type:String,required:!0},showCardFooter:{type:Boolean,default:!1}},data:function(){return{isShowFooter:this.showCardFooter}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"cardTable-thead"},[e._t("thead")],2),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},e._l(e.cardListData,function(t){return a("div",{key:t[e.rowKey],class:["cardTable-card",t.export_record>0?"row-height-light-normal":""]},[a("div",{class:["cardTable-cardHeader",t.export_record>0?"row-height-light-normal":""]},[e._t("cardheader",null,{cardRowData:t})],2),e._v(" "),a("div",{class:{"cardTable-cardMain":e.isShowFooter},staticStyle:{display:"flex"}},[e._t("cardRow",null,{cardRowData:t})],2),e._v(" "),e.showCardFooter?a("div",{class:["cardTable-cardFooter",t.export_record>0?"row-height-light-normal":""]},[e._t("cardfooter",null,{cardRowData:t})],2):e._e()])}),0)])},staticRenderFns:[]};var i=a("C7Lr")(r,s,!1,function(e){a("q9xk")},"data-v-3af9b3d2",null);t.a=i.exports},V2iy:function(e,t){},WyXV:function(e,t){},eaL6:function(e,t){},f862:function(e,t,a){"use strict";var r={name:"card-table-th",props:{width:{type:Number,required:!0}}},s={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"tacenter",style:"flex: "+this.width},[this._t("default")],2)},staticRenderFns:[]};var i=a("C7Lr")(r,s,!1,function(e){a("eaL6")},"data-v-0702ca1d",null);t.a=i.exports},kyzh:function(e,t){},q9xk:function(e,t){},t3k2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("4YfN"),s=a.n(r),i=a("lC5x"),n=a.n(i),o=a("J0Oq"),c=a.n(o),d=a("FkPv"),l=a("f862"),u=a("3UqK"),p={name:"DeliveryList",components:{"card-table":d.a,"card-table-th":l.a,"card-table-td":u.a},data:function(){return{exportOptions:[],id:null,is_refund:"",password:"",visible:!1,previewImg:"",paginationOptions:[{type:"warning",value:"send",label:"一键发货",permission:[this.$api.order.delivery.send]},{value:"template",label:"模板",permission:[this.$api.order.delivery.send]}],searchOPtions:[{type:"input",key:"order_sn",placeholder:"请输入订单号"},{type:"input",key:"goods_id",placeholder:"请输入商品ID"},{type:"input",key:"supplier",placeholder:"请输入供应商"},{type:"input",key:"receiver_name",placeholder:"收货人"},{type:"input",key:"receiver_mobile",placeholder:"收货人手机号"},{type:"input",key:"user_nickname",placeholder:"下单人"},{type:"input",key:"goods_price",placeholder:"商品价格"},{type:"datetimerange",key:"start_time-end_time",placeholder:"下单时间"},{type:"select",key:"status",placeholder:"发货状态",options:[{label:"已发货",value:3},{label:"待发货",value:2}]}],query:{},current:1,pageSize:10,count:0,express:[],closedialogVisible:!1,total_actual_money:"",listData:{items:[{}]},isCardTableLoading:!1}},activated:function(){this.getData(),this.getExpress()},methods:{tableRowClassName:function(e){var t=e.row;e.rowIndex;if(console.log(t.export_record),t.export_record>0)return"row-height-light-normal"},successUploadCBK:function(e){var t=this;0==e.code&&(this.$message({showClose:!0,message:"成功导入"+e.data.num+"行,"+e.data.msg,duration:3e3,type:"success"}),setTimeout(function(){t.getData()},1500))},handleDeliverySave:function(){var e=this;return c()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((a=e.listData.items.filter(function(e){return e.code&&e.sn}).map(function(e){return{id:e.id,code:e.code,sn:e.sn}})).length<1)){t.next=4;break}return e.$message.error("请选择快递及填写对应单号"),t.abrupt("return");case 4:return t.prev=4,t.next=7,e.$api.order.deliverySave({items:a});case 7:e.getData(),t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(4),new Error(t.t0);case 13:case"end":return t.stop()}},t,e,[[4,10]])}))()},handDeliveryImport:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,e.$refs.FileUpload.click(),t.next=7;break;case 4:throw t.prev=4,t.t0=t.catch(0),new Error(t.t0);case 7:case"end":return t.stop()}},t,e,[[0,4]])}))()},templateDownload:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,window.open(""+window.location.origin+e.$api.order.delivery.template),t.next=7;break;case 4:throw t.prev=4,t.t0=t.catch(0),new Error(t.t0);case 7:case"end":return t.stop()}},t,e,[[0,4]])}))()},handDeliverySend:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,e.$api.order.deliverySend().then(function(t){if(0===t.data)return e.$message.info("快递单号未设置，请先保存");e.$message.info("成功发出"+t.data+"个订单"),e.getData()}),t.next=7;break;case 4:throw t.prev=4,t.t0=t.catch(0),new Error(t.t0);case 7:case"end":return t.stop()}},t,e,[[0,4]])}))()},getExpress:function(){var e=this;return c()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.setting.getExpressList({status:10});case 3:a=t.sent,r=a.data,e.express=r.items,t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(0),new Error(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},transStatus:function(e){switch(e){case 0:return"已取消";case 1:return"待支付";case 2:return"待发货";case 3:return"待收货";case 4:return"待反馈";case 5:return"已完成";case 6:return"售后";case 7:return"已关闭"}},handelSearch:function(e,t){var a=this;({search:function(){a.query=s()({},t),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[e]()},getData:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.isCardTableLoading=!1,e.$api.order.odList(s()({page:e.current,pageSize:e.pageSize},e.query,{status:e.query.status?e.query.status:2})).then(function(t){e.count=t.data.count,e.listData=t.data,e.isCardTableLoading=!1,e.exportOptions=t.data.fields||[]});case 2:case"end":return t.stop()}},t,e)}))()},addSn:function(e){var t=this;return c()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.logistics_sn.trim()||!e.express_code){a.next=6;break}return r=[{id:e.id,code:e.express_code,sn:e.logistics_sn}],a.next=4,t.$api.order.deliverySave({items:r});case 4:a.next=7;break;case 6:t.$message.warning("请填写快递单号或者选择快递公司");case 7:case"end":return a.stop()}},a,t)}))()},handleSizeChange:function(e){this.pageSize=e,this.getData()},handlePageChange:function(e){this.current=e,this.getData()},orderDetail:function(e){this.$router.push({name:"orderDetail",params:{id:e}})},orderClose:function(){var e=this;return c()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.order.orderClose({id:e.id,is_refund:e.is_refund,password:e.password});case 3:e.closedialogVisible=!1,e.getData(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},handleOpreate:function(e){switch(e){case"send":this.handDeliverySend();break;case"template":this.templateDownload()}}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"min-height":"calc(100vh - 135px)",background:"#fff","border-radius":"4px"}},[a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}},[a("Export",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.order.delivery.export],expression:"[$api.order.delivery.export]"}],attrs:{exportOptions:e.exportOptions,query:e.query,url:e.$api.order.delivery.export}})],1),e._v(" "),a("div",{staticClass:"table-pandect table-pandect-hidden"},[e._v("\n        符合搜索条件的数据共 "),a("span",[e._v(e._s(e.count))]),e._v(" 个 总价 "),a("span",[e._v(e._s(e.total_actual_money))]),e._v(" 元\n    ")]),e._v(" "),a("div",{staticStyle:{padding:"0 20px 20px 20px",background:"#fff","border-radius":"4px"}},[a("card-table",{attrs:{loading:e.isCardTableLoading,cardListData:e.listData.items,rowKey:"id",showCardFooter:!1},scopedSlots:e._u([{key:"thead",fn:function(){return[a("card-table-th",{attrs:{width:220}},[e._v("商品信息")]),e._v(" "),a("card-table-th",{attrs:{width:140}},[e._v("单价/数量")]),e._v(" "),a("card-table-th",{attrs:{width:120}},[e._v("实付金额")]),e._v(" "),a("card-table-th",{attrs:{width:110}},[e._v("订单状态")]),e._v(" "),a("card-table-th",{attrs:{width:110}},[e._v("供应商/ID")]),e._v(" "),a("card-table-th",{attrs:{width:110}},[e._v("收货地址")]),e._v(" "),a("card-table-th",{attrs:{width:135}},[e._v("快递及单号")]),e._v(" "),a("card-table-th",{attrs:{width:114}},[e._v("导出记录")])]},proxy:!0},{key:"cardheader",fn:function(t){var r=t.cardRowData;return[a("span",{staticClass:"fcgrey"},[e._v("订单号：")]),a("span",{staticClass:"mr20"},[e._v(e._s(r.order_sn))]),e._v(" "),a("span",{staticClass:"fcgrey"},[e._v("提交时间：")]),a("span",{staticClass:"mr20"},[e._v(e._s(r.created_at))]),e._v(" "),a("span",{staticClass:"fcgrey"},[e._v("用户昵称：")]),a("span",{staticClass:"mr20"},[e._v(e._s(r.user_nickname))]),e._v(" "),a("span",{staticClass:"fcgrey"},[e._v("用户ID：")]),a("span",[e._v(e._s(r.user_id))]),e._v(" "),a("span",{staticClass:"fr"},[r.remark?a("el-tooltip",{attrs:{effect:"light",placement:"bottom-end",content:"卖家备注："+r.remark,offset:"8"}},[a("i",{staticClass:"el-icon-document fs16 fcred"})]):e._e()],1)]}},{key:"cardRow",fn:function(t){var r=t.cardRowData;return[a("card-table-td",{attrs:{width:320}},e._l(r.goods_list,function(t){return a("div",{key:t.goods_id,staticClass:"cardTableGood"},[a("img",{staticClass:"cardTableGoodImg",attrs:{src:t.goods_thumb}}),e._v(" "),a("div",{staticClass:"flex1 lh18 fs12"},[a("div",{staticClass:"dpflex"},[a("div",{staticClass:"flex1 fcblue mr8 mb8"},[e._v(e._s(t.goods_title))]),e._v(" "),a("div",{staticClass:"taright fcgrey width80"},[e._v("¥"+e._s(t.shop_price))])]),e._v(" "),a("div",{staticClass:"dpflex"},[a("div",{staticClass:"flex1 mr8"},[a("p",{staticClass:"fcgray"},[e._v(e._s(t.sku_properties_name))]),e._v(" "),a("p",{staticClass:"fcgray"},[e._v("商品ID："+e._s(t.goods_id))])]),e._v(" "),a("div",{staticClass:"taright fcgrey width80"},[e._v("x"+e._s(t.nums))])])])])}),0),e._v(" "),a("card-table-td",{attrs:{width:140}},[a("div",{staticClass:"cardTablePrice"},[a("p",{staticStyle:{color:"red"}},[e._v("¥"+e._s(r.actual_fee))]),e._v(" "),a("p",[e._v("（含订单运费：¥"+e._s(r.freight_fee)+"）")]),e._v(" "),a("p",[e._v("（含退换省心：¥"+e._s(r.insurance_fee)+"）")]),e._v(" "),""!==r.buyer_message?a("el-tooltip",{attrs:{effect:"dark",content:"买家备注："+r.buyer_message,placement:"top-start"}},[a("div",{staticClass:"dpinlineblock"},[a("i",{staticClass:"el-icon-document fs16 fcorange mr6"}),e._v("买家备注")])]):e._e()],1)]),e._v(" "),a("card-table-td",{attrs:{width:110}},[a("div",{staticClass:"cardTableInfo"},[e._v(e._s(r.status_name))])]),e._v(" "),a("card-table-td",{attrs:{width:110}},[a("div",{staticClass:"cardTableInfo"},[a("p",[e._v(e._s(r.supplier_name))]),e._v(" "),a("p",[e._v(e._s(r.supplier_id))])])]),e._v(" "),a("card-table-td",{attrs:{width:110}},[a("div",{staticClass:"cardTableInfo"},[e._v(e._s(r.receiver_address))])]),e._v(" "),a("card-table-td",{attrs:{width:110}},[a("div",{staticClass:"cardTableInfo"},[a("div",{staticStyle:{"margin-bottom":"16px"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:r.express_code,callback:function(t){e.$set(r,"express_code",t)},expression:"cardRowData.express_code"}},e._l(e.express,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.express_code}})}),1)],1),e._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请填写快递单号"},on:{blur:function(t){return e.addSn(r)}},model:{value:r.logistics_sn,callback:function(t){e.$set(r,"logistics_sn",t)},expression:"cardRowData.logistics_sn"}})],1)])]),e._v(" "),a("card-table-td",{attrs:{width:110}},[a("div",{staticClass:"cardTableInfo"},[e._v(e._s(r.export_record))])])]}}])})],1),e._v(" "),a("Pagination",{attrs:{options:e.paginationOptions,current:e.current,count:e.count,pageSize:e.pageSize,pageChoose:[10,30,50,100]},on:{opreateCBK:e.handleOpreate,pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange},scopedSlots:e._u([{key:"left-content",fn:function(){return[a("div",{staticStyle:{position:"absolute","padding-left":"158px","z-index":"-1"}},[a("FileUpload",{ref:"FileUpload",staticStyle:{display:"inline-block"},attrs:{isBotton:!0,url:e.$api.order.delivery.importfile},on:{successUploadCBK:e.successUploadCBK}})],1)]},proxy:!0}])}),e._v(" "),a("el-dialog",{attrs:{title:"关闭订单",visible:e.closedialogVisible,width:"30%"},on:{"update:visible":function(t){e.closedialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"是否退款："}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.is_refund,callback:function(t){e.is_refund=t},expression:"is_refund"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作密码："}},[a("el-input",{staticStyle:{width:"70%",margin:"0 5% 10px 0"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closedialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.orderClose}},[e._v("\n                确定\n            ")])],1)],1),e._v(" "),a("PreviewImg",{attrs:{visible:e.visible,imgSrc:e.previewImg},on:{"update:visible":function(t){e.visible=t}}})],1)},staticRenderFns:[]};var _=a("C7Lr")(p,v,!1,function(e){a("V2iy"),a("kyzh")},"data-v-7afa4087",null);t.default=_.exports}});