webpackJsonp([74],{g8gb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("4YfN"),l=a.n(n),i={name:"couponRecord",mixins:[a("8Rg7").a],data:function(){return{searchOPtions:[{type:"input",key:"uid",placeholder:"用户id"},{type:"input",key:"cid",placeholder:"优惠券id"},{type:"select",key:"is_used",placeholder:"状态",options:[{value:-1,label:"全部"},{value:0,label:"未使用"},{value:1,label:"已使用"}]}],tableData:[],multipeOptions:[{value:"del",label:"批量删除",type:"danger"}]}},mounted:function(){this.getData()},methods:{toogle:function(e){var t=this;this.$api.activity.couponRecordStatus({is_used:e.is_used,id:e.id}).then(function(e){t.getData()}).catch(function(t){console.log(t),e.is_used=0==e.is_used?1:0})},del:function(e){var t=this;this.$confirm("确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.handleDel(e)})},handleDel:function(e){var t=this;this.$api.activity.couponRecordDel({ids:e}).then(function(e){t.getData()})},handleMultipe:function(e){if(0!==this.multipleSelection.length)switch(e){case"del":this.del(this.multipleSelection.join(","))}else this.$message({message:"请至少选择一条数据",type:"error"})},getData:function(){var e=this;try{this.loading=!0,this.$api.activity.couponRecordList(l()({},this.query,{pageSize:this.pageSize,page:this.current})).then(function(t){e.loading=!1,e.tableData=t.data.items,e.count=t.data.count}).catch(function(t){e.loading=!1})}catch(e){this.loading=!1}}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"couponRecord-container"},[a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}}),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","highlight-current-row":!0,border:"",data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"id",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"uid",label:"用户ID"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"cid",label:"优惠券ID"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"coupon_name",width:"180",label:"优惠券名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"coupon_max",label:"满金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"coupon_money",label:"减金额"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"created_at",width:"140",label:"发放时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"end_time",width:"140",label:"到期时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",width:"100",label:"是否已使用"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){return e.toogle(t.row)}},model:{value:t.row.is_used,callback:function(a){e.$set(t.row,"is_used",a)},expression:"scope.row.is_used"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"updated_at",width:"140",label:"使用时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"order_id",label:"订单id"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.order_id||"--")+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",prop:"id",width:"80",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.activity.coupon.recordDel],expression:"[$api.activity.coupon.recordDel]"}],staticClass:"danger-color",attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),e.del(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("Pagination",{staticStyle:{width:"77% !important"},attrs:{current:e.current,count:e.count,pageSize:e.pageSize,options:e.multipeOptions},on:{pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange,opreateCBK:e.handleMultipe}})],1)},staticRenderFns:[]},r=a("C7Lr")(i,o,!1,null,null,null);t.default=r.exports}});