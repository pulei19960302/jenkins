webpackJsonp([28],{"1Dn1":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("IHPB"),n=a.n(i),o=a("aA9S"),s=a.n(o),r=a("lC5x"),l=a.n(r),d=a("J0Oq"),c=a.n(d),p=a("4YfN"),u=a.n(p),m=a("48sp"),v=a("czH5"),h=a("FFUX"),_=a("lEsE"),f={name:"ProductList",components:{ProductDetail:a("drEk").a},directives:{clickoutside:_.a},data:function(){return{navigation:[],exportOptions:[],nameEdit:null,detailData:{},multipleSelection:[],rghtPopupVisible:!1,loading:!1,visible:!1,previewImg:"",opreate:"",options:[],paginationOptions:[{value:"up",label:"批量上架",type:"primary",permission:[this.$api.product.addGoods.set_status]},{value:"pre",label:"批量预上架",type:"primary",permission:[this.$api.product.addGoods.set_status]},{value:"down",label:"批量下架",type:"warning",permission:[this.$api.product.addGoods.set_status]},{value:"del",label:"批量删除",type:"danger",permission:[this.$api.product.addGoods.del]}],activeName:"all",searchOPtions:[{type:"input",key:"keywords",placeholder:"商品编号 / 商品名称"},{type:"datetimerange_single_param",key:"end_time",placeholder:"下架时间"},{type:"select",key:"label_id",placeholder:"商品标签",options:[]},{type:"cascader",key:"cate_id",placeholder:"商品分类",options:[]},{type:"dateRangePicker",key:"start_at-end_at",placeholder:"上架日期"},{type:"select",key:"brand_id",placeholder:"品牌",options:[]},{type:"select",key:"supplier_id",placeholder:"供应商",options:[]}],query:{},current:1,pageSize:10,count:0,tableData:[],otherParams:{},topcount:{},process:1}},computed:u()({},Object(m.e)("user",["button_permissions"])),activated:function(){this.getData()},methods:{handleClickoutside:function(){},handleSave:function(e){var t=this,a=e.title,i=e.id;return c()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.product.setInfo({title:a,id:i});case 2:t.nameEdit=null;case 3:case"end":return e.stop()}},e,t)}))()},handleSave2:function(e){var t=e.sort,a=e.id;this.$api.product.setSort({id:a,sort:t}),this.nameEdit=null},delLabel:function(e,t){var a=this;return c()(l.a.mark(function i(){return l.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.$api.product.delLabelTable({label_id:e,id:t});case 2:a.tableData.forEach(function(i){if(i.id===t){var n=i.labels.filter(function(t){return t.id!==e});a.$set(i,"labels",n)}});case 3:case"end":return i.stop()}},i,a)}))()},edit:function(e,t){this[e]=t},handleCommand:function(e,t){var a=t.id;t.status;if("edit"===e)return this.jumpTo("EditProduct",e,a);if("copy"===e)return this.jumpTo("EditProduct",e,a);var i=void 0;switch(e){case"up":i=10;break;case"down":i=0;break;case"pre":i=1}this.handleDel(a,e,i)},jumpTo:function(e,t,a){this.$router.push({name:e,params:{type:t,id:a}})},lookDetails:function(e){this.detailData=s()({},e),this.rghtPopupVisible=!0},handleTabClick:function(e){this.process=e.name;var t={key:this.process};this.otherParams=t,this.getData()},handelSearch:function(e,t){var a=this;({search:function(){a.query=u()({},t),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[e]()},getData:function(){var e=this;return c()(l.a.mark(function t(){var a,i,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.query.cate_id&&(e.query.cate_id=[].concat(n()(e.query.cate_id)).splice(-1,1)),a=u()({},e.query,e.otherParams),t.next=6,e.$api.product.getGoodsList(u()({},a,{pageSize:e.pageSize,page:e.current}));case 6:i=t.sent,o=i.data,e.navigation=o.navigation,e.tableData=o.list.items,e.count=o.list.count,e.topcount=o.count,e.topcount.count=o.list.count,e.searchOPtions.forEach(function(e){switch(e.key){case"supplier_id":e.options=o.supplier.map(function(e){return{value:e.id,label:e.name}});break;case"brand_id":e.options=o.brand.map(function(e){return{value:e.id,label:e.name}});break;case"cate_id":e.options=o.category;break;case"goods_type":e.options=[].concat(n()(v.c.GOODS_TYPES));break;case"label_id":e.options=o.labels.map(function(e){return{value:e.id,label:e.label}})}}),e.exportOptions=o.fields||[],e.loading=!1,t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),e.loading=!1;case 21:case"end":return t.stop()}},t,e,[[0,18]])}))()},handlePageChange:function(e){this.current=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},handleSelectionChange:function(e){var t=e.map(function(e){return e.id});this.multipleSelection=t},handleOpreate:function(e){if(this.multipleSelection.length<1)this.$message.warning("请选择商品");else{var t=void 0;"up"==e?t=10:"down"==e?t=0:"pre"==e&&(t=1),this.handleDel(this.multipleSelection,e,t)}},handleDel:function(e,t,a){var i=this,n=void 0;if("del"===t)n="删除";else switch(a){case 10:n="上架";break;case 0:n="下架";break;case 1:n="预上架"}if("del"===t)this.$confirm("确认"+n+"选中商品？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(c()(l.a.mark(function n(){var o;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o=void 0,o=h.e.isArray(e)?e.join(","):e,n.prev=2,"del"!==t){n.next=8;break}return n.next=6,i.$api.product.delGoods({ids:o});case 6:n.next=10;break;case 8:return n.next=10,i.$api.product.setGoodsStatus({ids:o,status:a});case 10:i.getData(),n.next=16;break;case 13:throw n.prev=13,n.t0=n.catch(2),new Error(n.t0);case 16:case"end":return n.stop()}},n,i,[[2,13]])})));else{var o=void 0;o=h.e.isArray(e)?e.join(","):e,this.$api.product.setGoodsStatus({ids:o,status:a}).then(function(){i.getData()})}}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"product-list"},[a("div",{staticClass:"tab-top"},[a("el-tabs",{staticStyle:{background:"#fff",padding:"0 10px"},on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.navigation,function(t){return a("el-tab-pane",{key:t.key,attrs:{name:t.key}},[a("span",{staticStyle:{"font-weight":"bold"},attrs:{slot:"label"},slot:"label"},[e._v("\n            "+e._s(t.bar)+"("+e._s(t.count)+")\n          ")])])}),1)],1),e._v(" "),a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}},[a("el-button",{staticClass:"add-product-btn",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.jumpTo("AddProduct")}}},[e._v("添加商品")]),e._v(" "),a("Export",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.export],expression:"[$api.product.addGoods.export]"}],attrs:{exportOptions:e.exportOptions,query:e.query,url:e.$api.product.addGoods.export}})],1),e._v(" "),a("div",{staticClass:"table-pandect table-pandect-hidden"},[e._v("\n            符合搜索条件的数据共 "),a("b",[e._v(e._s(e.count))]),e._v(" 条\n        ")]),e._v(" "),a("div",{staticClass:"common-table-wrapper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","highlight-current-row":!0,border:"",data:e.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#fafafa",border:"none",borderBottom:"1px solid #e8e8e8"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"",width:"50",align:"center",type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",width:"60",align:"center",prop:"id",label:"商品ID"}}),e._v(" "),a("el-table-column",{attrs:{width:"120",align:"center",prop:"sort",label:"排序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClickoutside,expression:"handleClickoutside"}]},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.nameEdit!=t.row.id,expression:"nameEdit != scope.row.id"}],staticClass:"el-icon-edit-content"},[e._v("\n                            "+e._s(t.row.sort)+"\n                            "),a("i",{staticClass:"el-icon-edit icon",on:{click:function(a){return e.edit("nameEdit",t.row.id)}}})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.nameEdit==t.row.id,expression:"nameEdit == scope.row.id"}],staticStyle:{display:"flex"}},[a("el-input",{model:{value:t.row.sort,callback:function(a){e.$set(t.row,"sort",a)},expression:"scope.row.sort"}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"2px"},attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleSave2(t.row)}}},[e._v("保存")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"280",align:"center",prop:"title",label:"商品"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClickoutside,expression:"handleClickoutside"}]},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.nameEdit!=t.row.id,expression:"nameEdit != scope.row.id"}],staticClass:"product-info"},[a("div",{staticStyle:{"margin-right":"15px"}},[a("img",{staticClass:"table-img",attrs:{src:t.row.thumb},on:{click:function(a){e.previewImg=t.row.thumb,e.visible=!0}}})]),e._v(" "),a("div",{staticClass:"verical-title"},[a("div",{staticClass:"in"},[e._v("\n                  "+e._s(t.row.title)+"\n                ")])]),e._v(" "),a("i",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.add_second_post],expression:"[$api.product.addGoods.add_second_post]"}],staticClass:"el-icon-edit icon",on:{click:function(a){return e.edit("nameEdit",t.row.id)}}})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.nameEdit==t.row.id,expression:"nameEdit == scope.row.id"}],staticStyle:{display:"flex"}},[a("img",{staticClass:"table-img",attrs:{src:t.row.thumb},on:{click:function(a){e.previewImg=t.row.thumb,e.visible=!0}}}),e._v(" "),a("el-input",{staticStyle:{"margin-top":"10px","margin-left":"10px"},model:{value:t.row.title,callback:function(a){e.$set(t.row,"title",a)},expression:"scope.row.title"}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"12px"},attrs:{type:"text",size:"mini"},on:{click:function(a){return e.handleSave(t.row)}}},[e._v("保存")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"supplier_name",width:"100","show-overflow-tooltip":"",label:"供应商"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"category_name",width:"100",label:"商品分类"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"start_at",width:"140",label:"上架时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e._f("validVal")(t.row.start_at))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status_label",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.status_label)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"right",width:"100",label:"销售价（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",content:"一级返利"+t.row.goods_commission.first_fee+"；二级返利"+t.row.goods_commission.second_fee+"；天使一级返利"+t.row.goods_commission.team_angel1+"；天使二级返利"+t.row.goods_commission.team_angel2+"；钻石返利"+t.row.goods_commission.team_fee+"；",placement:"top"}},[a("span",[e._v(e._s(e._f("validVal")(t.row.shop_price)))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"stock",label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.stock)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"right",prop:"commission_price",width:"100",label:"佣金（元）"}}),e._v(" "),a("el-table-column",{attrs:{width:"100",align:"center",label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.labels&&t.row.labels.length>0?a("div",e._l(t.row.labels,function(i){return a("el-tag",{key:i.id,staticStyle:{"margin-right":"10px","margin-bottom":"3px"},attrs:{size:"mini",closable:"",type:"warning"},on:{close:function(a){return e.delLabel(i.id,t.row.id)}}},[e._v("\n                            "+e._s(i.label)+"\n                        ")])}),1):a("div",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sale_num",label:"销量"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"order_num",label:"订单量"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"140",prop:"tuan_start",label:"秒杀开始时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",width:"140",prop:"tuan_end",label:"秒杀结束时间"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",width:"160",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.detail],expression:"[$api.product.addGoods.detail]"}],attrs:{type:"text",size:"mini"},on:{click:function(a){return a.stopPropagation(),e.lookDetails(t.row)}}},[e._v("\n                        查看\n                    ")]),e._v(" "),a("el-dropdown",{on:{command:function(a){return e.handleCommand(a,t.row)}}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n                            更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.add_second_post],expression:"[$api.product.addGoods.add_second_post]"}],attrs:{command:"edit"}},[a("span",{staticStyle:{color:"#2d8cf0"}},[e._v("编辑")])]),e._v(" "),a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.add_second_post],expression:"[$api.product.addGoods.add_second_post]"}],attrs:{command:"copy"}},[a("span",{staticStyle:{color:"#909399"}},[e._v("复制")])]),e._v(" "),0==t.row.status?a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.set_status],expression:"[$api.product.addGoods.set_status]"}],attrs:{command:"pre"}},[a("span",{staticStyle:{color:"#e6a23c"}},[a("span",[e._v("预上架")])])]):e._e(),e._v(" "),0==t.row.status||1==t.row.status?a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.set_status],expression:"[$api.product.addGoods.set_status]"}],attrs:{command:"up"}},[a("span",{staticStyle:{color:"#e6a23c"}},[a("span",[e._v("上架")])])]):e._e(),e._v(" "),1==t.row.status||10==t.row.status?a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.set_status],expression:"[$api.product.addGoods.set_status]"}],attrs:{command:"down"}},[a("span",{staticStyle:{color:"#e6a23c"}},[a("span",[e._v("下架")])])]):e._e(),e._v(" "),"delflag"!==e.activeName?a("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:[e.$api.product.addGoods.del],expression:"[$api.product.addGoods.del]"}],attrs:{command:"del"}},[a("span",{staticStyle:{color:"#f56c6c"}},[e._v("删除")])]):e._e()],1)],1)]}}])})],1)],1),e._v(" "),a("Pagination",{attrs:{options:e.paginationOptions,current:e.current,pageSize:e.pageSize,count:e.count},on:{opreateCBK:e.handleOpreate,pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange}}),e._v(" "),a("PreviewImg",{attrs:{visible:e.visible,imgSrc:e.previewImg},on:{"update:visible":function(t){e.visible=t}}}),e._v(" "),a("RightSidePopup",{attrs:{visible:e.rghtPopupVisible,width:"60%"},on:{"update:visible":function(t){e.rghtPopupVisible=t}}},[a("ProductDetail",{attrs:{detailData:e.detailData}})],1)],1)},staticRenderFns:[]};var w=a("C7Lr")(f,b,!1,function(e){a("SUJ0"),a("P60u")},"data-v-95d302fe",null);t.default=w.exports},P60u:function(e,t){},SUJ0:function(e,t){}});