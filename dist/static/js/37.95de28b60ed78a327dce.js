webpackJsonp([37],{"0LB9":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("4YfN"),l=a.n(n),i=a("IHPB"),r=a.n(i),o=a("lC5x"),c=a.n(o),s=a("J0Oq"),u=a.n(s),d={name:"index",props:{},components:{},data:function(){return{loading:!1,visible:!1,previewImg:"",options:[],dialogVisible:!1,form:{title:"",content:""},rules:{title:[{required:!0,message:"请输入",trigger:"change"}],content:[{required:!0,message:"请输入",trigger:"change"}]},isSwitch:!0,searchOPtions:[{type:"input",key:"keywords",placeholder:"商品编号 / 商品名称"},{type:"select",key:"supplier_id",placeholder:"供应商",options:[]},{type:"select",key:"brand_id",placeholder:"商品品牌",options:[]},{type:"cascader",key:"cate_id",placeholder:"商品分类",options:[]},{type:"select",key:"status",placeholder:"状态",options:[{label:"启用",value:10},{label:"禁用",value:0}]}],query:{},current:1,pageSize:10,count:0,tableData:[],columnSelect:[],data:[],defaultProps:{children:"children",label:"label"}}},computed:{},watch:{},activated:function(){this.getData(),this.getTree()},methods:{delLabel:function(e,t){var a=this;return u()(c.a.mark(function n(){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.$api.product.delLabelTable({label_id:e,id:t});case 2:a.tableData.forEach(function(n){if(n.id===t){var l=n.labels.filter(function(t){return t.id!==e});a.$set(n,"labels",l)}});case 3:case"end":return n.stop()}},n,a)}))()},putaway:function(e){var t=e.id;this.$router.push({name:"EditProduct",params:{id:t,type:"addBySourcingCenter"}})},handleNodeClick:function(e){this.query.cate_id=e.id,this.getData()},handelSearch:function(e,t){var a=this;({search:function(){t.cate_id&&(t.cate_id=[].concat(r()(t.cate_id)).splice(-1,1)),a.query=l()({},t),a.current=1,a.getData()},reset:function(){a.query={},a.pageSize=10,a.current=1,a.getData()}})[e]()},getTree:function(){var e=this;return u()(c.a.mark(function t(){var a,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.product.tree();case 2:a=t.sent,n=a.data,e.data=n.category;case 5:case"end":return t.stop()}},t,e)}))()},getData:function(){var e=this;return u()(c.a.mark(function t(){var a,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$api.product.getGoodsList(l()({},e.query,{pageSize:e.pageSize,page:e.current}));case 4:a=t.sent,n=a.data,e.tableData=n.list.items,e.count=n.list.count,e.searchOPtions.forEach(function(e){switch(e.key){case"supplier_id":e.options=n.supplier.map(function(e){return{value:e.id,label:e.name}});break;case"brand_id":e.options=n.brand.map(function(e){return{value:e.id,label:e.name}});break;case"cate_id":e.options=n.category}}),e.loading=!1,t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(1),e.loading=!1,new Error;case 16:case"end":return t.stop()}},t,e,[[1,12]])}))()},handlePageChange:function(e){this.current=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},jumpTo:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"add";this.$router.push({name:e,params:{type:t,id:a}})},handleSelectionChange:function(e){var t=[];e.length<1?this.columnSelect=[]:(e.map(function(e){t.push(e.id)}),this.columnSelect=t)},handleDel:function(e){var t=this;this.$confirm("确认删除选中商品？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.del(e)})},del:function(e){var t=this;if("many"==e){if(this.columnSelect.length<1)return void this.$message({message:"请至少选择一条申请",type:"error"});this.$api.product.goodDelall({ids:this.columnSelect.join(",")}).then(function(){t.getData()})}else this.$api.product.goodDel({id:e}).then(function(){t.getData()})},show:function(e){var t=l()({},e);t.display_index=1==t.display_index?1:0,t.display=1==t.display?1:0,this.$api.product.goodEdit(t)},handleCommand:function(e){"listDel"!=e.name?this.$router.push({name:e.name,params:{type:e.type,id:e.id}}):this.handleDel(e.id)},composeValue:function(e,t,a){return{name:e,type:t,id:a}}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sourcing-center"},[a("Search",{attrs:{searchOPtions:e.searchOPtions},on:{searchCallback:e.handelSearch}}),e._v(" "),a("div",{staticClass:"sourcing-center-content"},[a("el-tree",{staticStyle:{width:"150px","margin-top":"4px"},attrs:{data:e.data,props:e.defaultProps},on:{"node-click":e.handleNodeClick}}),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-spinner":"el-icon-loading","highlight-current-row":!0,border:"",data:e.tableData,"tooltip-effect":"dark","header-cell-style":{background:"#fafafa",border:"none",borderBottom:"1px solid #e8e8e8"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{width:"60",align:"center",prop:"id",label:"编号"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"title",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"supplier_name",label:"供应商"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"title",label:"商品分类"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"缩略图"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticClass:"photo",staticStyle:{width:"50px",height:"50px"},attrs:{src:t.row.thumb,alt:""},on:{click:function(a){e.previewImg=t.row.thumb,e.visible=!0}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"price",label:"价格&规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("价格：￥"+e._s(t.row.shop_price))]),e._v(" "),a("p",[e._v("货号："+e._s(t.row.goods_sn))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"120",align:"center",label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.labels,function(n){return a("el-tag",{key:n.id,staticStyle:{"margin-right":"10px","margin-bottom":"3px"},attrs:{size:"mini",closable:"",type:"warning"},on:{close:function(a){return e.delLabel(n.id,t.row.id)}}},[e._v("\n                        "+e._s(n.label)+"\n                    ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sort",label:"价格竞争指数"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"stock",label:"库存"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"sale_num",label:"销量"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[10==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v("启用")]):a("span",{staticStyle:{color:"red"}},[e._v("禁用")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",plain:"",size:"mini"},on:{click:function(a){return e.putaway(t.row)}}},[e._v("\n                        上架\n                    ")])]}}])})],1)],1),e._v(" "),a("Pagination",{attrs:{current:e.current,pageSize:e.pageSize,count:e.count},on:{opreateCBK:function(t){return e.handleDel("many")},pageChangeCBK:e.handlePageChange,sizeChangeCBK:e.handleSizeChange}}),e._v(" "),a("el-dialog",{attrs:{title:"转移商品",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"原商品分类："}},[a("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"目标商品分类："}},[a("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n                开始转移\n            ")])],1)],1),e._v(" "),a("PreviewImg",{attrs:{visible:e.visible,imgSrc:e.previewImg},on:{"update:visible":function(t){e.visible=t}}})],1)},staticRenderFns:[]};var h=a("C7Lr")(d,p,!1,function(e){a("o4gp")},"data-v-d9575414",null);t.default=h.exports},o4gp:function(e,t){}});