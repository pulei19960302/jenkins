(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{"9Aer":function(e,t,n){"use strict";n.r(t);var a=n("2Taf"),r=n.n(a),i=n("vZ4D"),o=n.n(i),l=n("MhPg"),c=n.n(l),s=n("l4Ni"),u=n.n(s),d=n("ujKo"),p=n.n(d),m=n("q1tI"),f=n.n(m),h=n("MuoO"),v=n("Kvkj"),g={ADD:"\u65b0\u589e",EDIT:"\u91cd\u547d\u540d",DEL:"\u5220\u9664"},y={MEMBERS:1,SECURITY:2},E=[{title:"\u6210\u5458\u7ba1\u7406",value:y.MEMBERS,key:"members"},{title:"\u89d2\u8272\u7ba1\u7406",value:y.SECURITY,key:"security"}],_=(n("qVdP"),n("jsC+")),R=(n("lUTK"),n("BvKs")),k=(n("2qtc"),n("kLXV")),b=(n("miYZ"),n("tsqr")),C=n("p0pE"),D=n.n(C),x=(n("ozfa"),n("MJZm")),M=n("w5pM"),S=n("G3dp"),L=n("/MfK"),w=n("GZ0F"),N=n("gUdW"),I=n("xGfz"),T=(n("7Qib"),n("5NDa"),n("5rEg")),P=n("WsrF");n("XlDN");function O(e){return function(){var t,n=p()(e);if(A()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function A(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var F,B,V,$={labelCol:{sm:{span:5}},wrapperCol:{sm:{span:18}}},K=function(e){c()(n,e);var t=O(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.state={loading:!1},e.handleOk=function(){var t=e.props,n=t.form,a=t.onCancel,r=t.successCallback,i=t.department;n.validateFields(function(t,n){if(!t)if(i.id){var o=[D()({},n,{id:i.id})];$api.permissions.updateDepartment({departments:o},{success:!0,loadingFn:e.toogleLoading}).then(function(){a(),r()})}else $api.permissions.addDepartment(D()({},n,{parent_id:i.parent_id}),{success:!0,loadingFn:e.toogleLoading}).then(function(){a(),r()})})},e.toogleLoading=function(t){e.setState({loading:t})},e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,n=e.onCancel,a=e.modalVisible,r=e.department,i=this.state.loading,o={title:r.id?"\u7f16\u8f91\u90e8\u95e8":"\u65b0\u589e\u90e8\u95e8",width:500,confirmLoading:i,visible:a,destroyOnClose:!0,maskClosable:!1,onOk:this.handleOk,onCancel:n};return f.a.createElement(k["a"],o,f.a.createElement(P["a"],$,r.ptitle&&f.a.createElement(P["a"].Item,{label:"\u6240\u5c5e\u90e8\u95e8"},r.ptitle),f.a.createElement(P["a"].Item,{label:"\u90e8\u95e8\u540d\u79f0"},t("department_name",{initialValue:r.department_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u90e8\u95e8\u540d\u79f0(\u965010\u5b57)"}]})(f.a.createElement(T["a"],{maxLength:10})))))}}]),n}(m["PureComponent"]),q=P["a"].create()(K);function j(e){return function(){var t,n=p()(e);if(G()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function G(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var H=x["a"].TreeNode,z=(F=Object(h["connect"])(function(e){var t=e.members;return D()({},t)}),F((V=function(e){c()(n,e);var t=j(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.state={modalVisible:!1,selectDepartment:{}},e.getDepartmentList=function(){var t=e.props.dispatch;t({type:"members/getDepartmentList"})},e.onExpand=function(t){var n=e.props.dispatch;n({type:"members/updateState",payload:{expandedKeys:t}})},e.toggleModal=function(t){e.setState({modalVisible:t})},e.addDepartment=function(t){var n=t.id,a=t.department_name;e.setState({selectDepartment:{parent_id:n,ptitle:a}}),e.toggleModal(!0)},e.editDepartment=function(t){e.setState({selectDepartment:t}),e.toggleModal(!0)},e.delDepartment=function(t){var n=!0;if(t.count?n=!1:t.children&&t.children.length>0&&(n=!t.children.find(function(e){return e.cout>0})),n){var a=[t.id];t.children&&t.children.length>0&&t.children.forEach(function(e){a.push(e.id)}),console.log(a),k["a"].confirm({title:"\u5220\u9664\u90e8\u95e8",content:"\u786e\u8ba4\u5220\u9664\u8be5\u90e8\u95e8\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){$api.permissions.deleteDepartment({department_ids:a},{success:!0}).then(function(){e.getDepartmentList()})}})}else b["a"].warning("\u8be5\u90e8\u95e8\u6216\u5176\u5b50\u90e8\u95e8\u4e0b\u8fd8\u6709\u6210\u5458\uff0c\u5220\u9664\u5931\u8d25\uff01",3)},e.getSearchDepartment=function(t,n,a){var r=e.props.treeData;if(!t)return"\u6240\u6709\u90e8\u95e8";for(var i=0;i<n.length;i++){var o=n[i];if(o.id===t){a.unshift(o.department_name),0!==o.parent_id&&e.getSearchDepartment(o.parent_id,r,a);break}o.children&&o.children.length&&e.getSearchDepartment(t,o.children,a)}return a.join("-")},e.onSelect=function(t){var n=e.props,a=n.dispatch,r=n.treeData,i=e.getSearchDepartment(+t[0],r,[]);a({type:"members/updateState",payload:{selectedKeys:t,searchDepartment:i}}),a({type:"members/getList",payload:{department_id:t[0]||""}})},e.handleMenuClick=function(t){var n=t.item,a=t.key,r=t.domEvent,i=n.props.data;switch(a){case"add":e.addDepartment(i);break;case"edit":e.editDepartment(i);break;case"del":e.delDepartment(i);break}r.stopPropagation()},e.renderMenuItem=function(t){return f.a.createElement(R["a"],{onClick:e.handleMenuClick},$api.permissions.addDepartment.permission()&&0===t.parent_id&&f.a.createElement(R["a"].Item,{key:"add",data:t,className:"permissionMenuItem"},f.a.createElement(M["a"],null),"\xa0\u6dfb\u52a0"),$api.permissions.updateDepartment.permission()&&f.a.createElement(R["a"].Item,{key:"edit",data:t,className:"permissionMenuItem"},f.a.createElement(S["a"],null),"\xa0\u91cd\u547d\u540d"),$api.permissions.deleteDepartment.permission()&&f.a.createElement(R["a"].Item,{key:"del",data:t,className:"permissionMenuItem"},f.a.createElement(L["a"],null),"\xa0\u5220\u9664"))},e.renderTreeNodeTitle=function(t){var n=t.department_name;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"nodeTitle"},f.a.createElement("span",{className:"name"},n),f.a.createElement("span",{className:"operate",onClick:function(e){e.stopPropagation()}},f.a.createElement(_["a"],{overlay:e.renderMenuItem(t),trigger:["hover"]},f.a.createElement(w["a"],null)))))},e.renderTreeNodes=function(t){var n=e.props.expandedKeys;return t.map(function(t){return t.children&&Array.isArray(t.children)&&t.children.length>0?f.a.createElement(H,{style:{position:"relative"},switcherIcon:n.includes(t.id+"")?f.a.createElement(N["a"],null):f.a.createElement(I["a"],null),title:e.renderTreeNodeTitle(t),key:t.id},e.renderTreeNodes(t.children)):f.a.createElement(H,{title:e.renderTreeNodeTitle(t),key:t.id,style:{position:"relative"}})})},e}return o()(n,[{key:"componentDidMount",value:function(){this.getDepartmentList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.modalVisible,a=t.selectDepartment,r=this.props,i=r.expandedKeys,o=r.selectedKeys,l=r.treeData;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"header"},$api.permissions.addDepartment.permission()&&f.a.createElement("div",{onClick:function(){e.addDepartment({id:0})}},f.a.createElement(M["a"],null),"\xa0\xa0\u6dfb\u52a0\u90e8\u95e8")),f.a.createElement("div",{className:"tree"},f.a.createElement(x["a"],{onExpand:this.onExpand,onSelect:this.onSelect,expandedKeys:i,selectedKeys:o},this.renderTreeNodes(l))),f.a.createElement(q,{department:a,onCancel:function(){return e.toggleModal(!1)},modalVisible:n,successCallback:this.getDepartmentList}))}}]),n}(m["PureComponent"]),B=V))||B),Y=z,J=(n("+L6B"),n("2/Rp")),U=(n("+BJd"),n("mr32")),W=(n("nRaC"),n("5RzL")),X=(n("OaEy"),n("2fM7"));function Z(e){return function(){var t,n=p()(e);if(Q()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function Q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var ee,te,ne,ae=P["a"].Item,re=X["a"].Option,ie={labelCol:{sm:{span:5}},wrapperCol:{sm:{span:18}}},oe=function(e){c()(n,e);var t=Z(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.state={loading:!1},e.handleOk=function(){var t=e.props,n=t.form,a=t.onCancel,r=t.successCallback,i=t.member;n.validateFields(function(t,n){t||(i.id?$api.permissions.updateMember(D()({},n,{member_id:i.id}),{success:!0,loadingFn:e.toogleLoading}).then(function(e){a(),r()}):$api.permissions.addMember(D()({},n),{success:!0,loadingFn:e.toogleLoading}).then(function(e){a(),r({page:1})}))})},e.toogleLoading=function(t){e.setState({loading:t})},e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,n=e.onCancel,a=e.modalVisible,r=e.roleList,i=e.treeData,o=e.member,l=this.state.loading,c={title:o.id?"\u7f16\u8f91\u6210\u5458":"\u65b0\u589e\u6210\u5458",width:500,confirmLoading:l,visible:a,destroyOnClose:!0,maskClosable:!1,onOk:this.handleOk,onCancel:n};return console.log(o),f.a.createElement(k["a"],c,f.a.createElement(P["a"],ie,f.a.createElement(P["a"].Item,{label:"\u6210\u5458\u8d26\u53f7"},t("member_account",{initialValue:o.username,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6210\u5458\u8d26\u53f7"}]})(f.a.createElement(T["a"],{maxLength:20}))),f.a.createElement(P["a"].Item,{label:"\u767b\u5f55\u5bc6\u7801"},t("member_password",{rules:[{required:!o.id,message:"\u8bf7\u586b\u5199\u767b\u5f55\u5bc6\u7801"}]})(f.a.createElement(T["a"],{type:"password",maxLength:20}))),f.a.createElement(P["a"].Item,{label:"\u6210\u5458\u59d3\u540d"},t("member_name",{initialValue:o.name})(f.a.createElement(T["a"],{maxLength:10}))),f.a.createElement(ae,{label:"\u6210\u5458\u89d2\u8272"},t("role_id",{initialValue:o.role_ids?o.role_ids.split(",").map(function(e){return+e}):void 0,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6210\u5458\u89d2\u8272"}]})(f.a.createElement(X["a"],{mode:"multiple"},r.map(function(e){return f.a.createElement(re,{value:e.value,key:e.value},e.name)})))),f.a.createElement(ae,{label:"\u6240\u5c5e\u90e8\u95e8"},t("department_id",{initialValue:o.group_id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6240\u5c5e\u90e8\u95e8"}]})(f.a.createElement(W["a"],{showSearch:!0,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeDefaultExpandAll:!0,treeData:i})))))}}]),n}(m["PureComponent"]),le=P["a"].create()(oe),ce=(n("/zsF"),n("PArb")),se=function(){var e=this;return[{title:"\u6210\u5458\u8d26\u53f7",dataIndex:"username"},{title:"\u6210\u5458\u59d3\u540d",dataIndex:"name"},{title:"\u7528\u6237\u5206\u7ec4",dataIndex:"group_name"},{title:"\u6210\u5458\u89d2\u8272",dataIndex:"role_names",width:180,tableOverflow:!0},{title:"\u6dfb\u52a0\u65f6\u95f4",dataIndex:"created_at"},{title:"\u64cd\u4f5c",width:120,render:function(t,n){return f.a.createElement("div",null,$api.permissions.updateMember.permission()&&f.a.createElement(m["Fragment"],null,f.a.createElement("a",{onClick:function(){e.editMember(n)}},"\u7f16\u8f91"),f.a.createElement(ce["a"],{type:"vertical"})),$api.permissions.deleteMember.permission()&&f.a.createElement("a",{onClick:function(){e.deleteMember([n.id])}},"\u5220\u9664"))}}]},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[{key:"member_account",placeholder:"\u6210\u5458\u8d26\u53f7"},{key:"member_name",placeholder:"\u6210\u5458\u59d3\u540d"},{key:"role_id",placeholder:"\u6210\u5458\u89d2\u8272",type:"enum",enums:e}]};function de(e){return function(){var t,n=p()(e);if(pe()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function pe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var me=[{name:"\u6279\u91cf\u5220\u9664",key:"delete"}],fe=(ee=Object(h["connect"])(function(e){var t=e.loading,n=e.app,a=e.members;return D()({loading:t,app:n},a)}),ee((ne=function(e){c()(n,e);var t=de(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.state={modalVisible:!1,selectMember:{},roleList:[]},e.getRole=function(){$api.permissions.getRolesList().then(function(t){var n=t.data;e.setState({roleList:n.map(function(e){return e.value=e.id,e.name=e.role_name,e})})})},e.getList=function(t){var n=e.props.dispatch;n({type:"members/getList",payload:t})},e.handleSearch=function(t){var n=e.props.dispatch;n({type:"members/onSearch",payload:t}),n({type:"members/getList",payload:{page:1}})},e.toggleModal=function(t){e.setState({modalVisible:t})},e.editMember=function(t){e.setState({selectMember:t}),e.toggleModal(!0)},e.addMember=function(){e.setState({selectMember:{}}),e.toggleModal(!0)},e.deleteMember=function(t,n){k["a"].confirm({title:n?"\u786e\u8ba4\u5220\u9664\u6240\u9009\u6210\u5458\u4e48?":"\u786e\u8ba4\u5220\u9664\u8be5\u6210\u5458\u4e48?",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){$api.permissions.deleteMember({member_ids:t}).then(function(){b["a"].success("\u5220\u9664\u6210\u529f"),e.getList()})}})},e.mutipulClick=function(t,n){switch(t){case"delete":e.deleteMember(n,!0);break}},e}return o()(n,[{key:"componentDidMount",value:function(){this.getRole(),this.getList()}},{key:"render",value:function(){var e=this,t=this.props.app.collapsed?"calc(100% - 378px)":"calc(100% - 468px)",n=this.state,a=n.modalVisible,r=n.selectMember,i=n.roleList,o=this.props,l=o.loading,c=o.list,s=o.pagination,u=o.searchDepartment,d=o.treeData;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"searchDepartment"},f.a.createElement(U["a"],{color:"cyan"},u)),$api.permissions.addMember.permission()&&f.a.createElement(J["a"],{type:"primary",className:"addMember",onClick:this.addMember},"\u6dfb\u52a0\u6210\u5458"),f.a.createElement(v["i"],{loading:l.effects["members/getList"],getList:this.getList,dataSource:c,columns:se.call(this),mutipulBtns:me,mutipulClick:this.mutipulClick,pagination:s,pageProps:{stylePros:{width:t,bottom:16}},searchFields:ue(i),onSearch:this.handleSearch}),f.a.createElement(le,{roleList:i,treeData:d,member:r,onCancel:function(){return e.toggleModal(!1)},modalVisible:a,successCallback:this.getList}))}}]),n}(m["PureComponent"]),te=ne))||te),he=fe,ve=n("wTCv"),ge=n.n(ve);function ye(e){return function(){var t,n=p()(e);if(Ee()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function Ee(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var _e,Re,ke,be=function(e){c()(n,e);var t=ye(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"render",value:function(){return f.a.createElement(v["x"],{className:ge.a.page},f.a.createElement("div",{className:ge.a.container},f.a.createElement("div",{className:"left"},f.a.createElement(Y,null)),f.a.createElement("div",{className:"right"},f.a.createElement(he,null))))}}]),n}(m["PureComponent"]),Ce=(n("T2oS"),n("W9HT")),De=(n("Mwp2"),n("VXEj")),xe=n("eHn4"),Me=n.n(xe),Se=n("TSYQ"),Le=n.n(Se),we=n("jehZ"),Ne=n.n(we),Ie=n("d6i3"),Te=n.n(Ie),Pe=n("1l/V"),Oe=n.n(Pe),Ae=n("f3b+"),Fe=n.n(Ae);function Be(e){return function(){var t,n=p()(e);if(Ve()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function Ve(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var $e,Ke,qe,je={labelCol:{sm:{span:5}},wrapperCol:{sm:{span:18}}},Ge=(_e=P["a"].create(),_e((ke=function(e){c()(n,e);var t=Be(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.handleCancel=function(){var t=e.props.onCancel;t&&t()},e.handleOk=function(){var t=e.props,n=t.form,a=t.dispatch,r=t.onCancel;n.validateFields(function(){var e=Oe()(Te.a.mark(function e(t,i){var o,l,c;return Te.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:o=i||{},l=o.role_name,c=void 0===l?"":l,$api.permissions.createRole({role_name:c}).then(function(e){e.data;r&&r(),a({type:"security/updateRolesList"})}).catch(function(e){var t=e.message,a=void 0===t?"\u6b64\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165!":t;n.setFields({role_name:{errors:[new Error(a)]}})});case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())},e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=t.getFieldDecorator;return f.a.createElement(k["a"],{title:"\u6dfb\u52a0\u89d2\u8272",visible:n,maskClosable:!1,destroyOnClose:!0,onCancel:this.handleCancel,onOk:this.handleOk},f.a.createElement(P["a"],Ne()({autoComplete:"off",className:Fe.a.addRole},je),f.a.createElement(P["a"].Item,{label:"\u540d\u79f0"},a("role_name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u89d2\u8272\u540d\u79f0"}]})(f.a.createElement(T["a"],{maxLength:20,placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",autoComplete:"off"})))))}}]),n}(m["PureComponent"]),Re=ke))||Re),He=Ge;function ze(e){return function(){var t,n=p()(e);if(Ye()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function Ye(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Je,Ue,We,Xe={wrapperCol:{span:18}},Ze=($e=P["a"].create(),$e((qe=function(e){c()(n,e);var t=ze(n);function n(){var e;r()(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.handleCancel=function(){var t=e.props.onCancel;t&&t()},e.handleOk=function(){var t=e.props,n=t.form,a=t.editRole,r=void 0===a?{}:a,i=t.dispatch,o=r.id;n.validateFields(function(){var t=Oe()(Te.a.mark(function t(n,a){var r,l,c;return Te.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=2;break}return t.abrupt("return");case 2:r=a||{},l=r.role_name,c=void 0===l?"":l,i({type:"security/updateRole",payload:{role_name:c,id:o}}).then(function(t){e.handleCancel()});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())},e}return o()(n,[{key:"render",value:function(){var e=this.props,t=e.form,n=e.visible,a=e.editRole,r=void 0===a?{}:a,i=t.getFieldDecorator,o=r.role_name,l=void 0===o?"":o;return f.a.createElement(k["a"],{title:"\u4fee\u6539\u89d2\u8272\u540d\u79f0",visible:n,maskClosable:!1,destroyOnClose:!0,onCancel:this.handleCancel,onOk:this.handleOk},f.a.createElement(P["a"],Ne()({autoComplete:"off",className:Fe.a.addRole},Xe),f.a.createElement(P["a"].Item,{label:"\u540d\u79f0"},i("role_name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u89d2\u8272\u540d\u79f0"}],initialValue:l})(f.a.createElement(T["a"],{maxLength:20,placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",autoComplete:"off"})))))}}]),n}(m["PureComponent"]),Ke=qe))||Ke),Qe=Ze;function et(e){return function(){var t,n=p()(e);if(tt()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function tt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var nt=(Je=P["a"].create(),Je((We=function(e){c()(n,e);var t=et(n);function n(e){var a;return r()(this,n),a=t.call(this,e),a.toggleAddRole=function(e){a.setState({addRoleModal:e})},a.toggleEditRole=function(e){a.setState({editRoleModal:e})},a.handleMenuClick=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.item,n=void 0===t?{}:t,r=e.key,i=(e.keyPath,e.domEvent,n.props),o=void 0===i?{}:i,l=o.details,c=void 0===l?{}:l;switch(r){case"edit":a.handelMenuEdit(c);break;case"del":a.handleMenuDel(c.id);break}},a.handelMenuEdit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.setState({editRole:e}),a.toggleEditRole(!0)},a.handleMenuDel=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.props.dispatch;k["a"].confirm({title:"\u591a\u4e2a\u6210\u5458\u6b63\u5728\u4f7f\u7528\u5f53\u524d\u89d2\u8272\uff0c\u5220\u9664\u540e\u6240\u6709\u6210\u5458\u5c06\u89e3\u9664\u76f8\u5173\u6743\u9650\uff0c\u662f\u5426\u786e\u8ba4\u5220\u9664\uff1f",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){t({type:"security/deleteRole",payload:{role_id:e}})}})},a.handleSelectRole=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=a.props,n=t.dispatch,r=t.selectedRole;e!==r&&n({type:"security/updateSelectedRole",payload:{id:e}})},a.renderMenuItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.id;return f.a.createElement(R["a"],{onClick:a.handleMenuClick},f.a.createElement(R["a"].Item,{key:"edit",details:e,style:{height:"32px",lineHeight:"32px"}},f.a.createElement(S["a"],{style:{fontSize:"16px",color:"#666666bf"}}),g.EDIT),$api.permissions.deleteRole.permission()&&f.a.createElement(R["a"].Item,{key:"del",details:e,style:{height:"32px",lineHeight:"32px"}},f.a.createElement(L["a"],{style:{fontSize:"16px",color:"#666666bf"}}),g.DEL))},a.renderListItem=function(e){var t=a.props,n=t.selectedRole,r=(t.roles,e.role_name),i=void 0===r?"":r,o=e.id,l=void 0===o?"":o,c=e.lock,s=void 0!==c&&c;return f.a.createElement(De["b"].Item,{className:Le()(Me()({},Fe.a.selectedRole,l===n)),onClick:function(){a.handleSelectRole(l)}},f.a.createElement("div",{className:Fe.a.more},f.a.createElement("span",null,i),!s&&f.a.createElement("span",{onClick:function(e){e.stopPropagation()}},f.a.createElement(_["a"],{overlay:a.renderMenuItem(e),trigger:["hover"]},f.a.createElement(w["a"],null)))))},a.state={addRoleModal:!1,editRoleModal:!1,editRole:{}},a}return o()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.roles,a=t.dispatch,r=this.state,i=r.addRoleModal,o=r.editRoleModal,l=r.editRole;return f.a.createElement("div",{className:Fe.a.roles},$api.permissions.createRole.permission()&&f.a.createElement("div",{className:Fe.a.addBtn,onClick:function(){e.toggleAddRole(!0)}},f.a.createElement(M["a"],null),f.a.createElement("span",null,"\xa0\xa0\u6dfb\u52a0\u89d2\u8272")),f.a.createElement(De["b"],{className:Fe.a.rolesList,dataSource:n,renderItem:this.renderListItem}),f.a.createElement(He,{visible:i,dispatch:a,onCancel:function(){e.toggleAddRole(!1)}}),f.a.createElement(Qe,{visible:o,editRole:l,dispatch:a,onCancel:function(){e.toggleEditRole(!1)}}))}}]),n}(m["PureComponent"]),Ue=We))||Ue),at=nt,rt=n("sEfC"),it=n.n(rt),ot=(n("sRBo"),n("kaz8")),lt=n("BkRI"),ct=n.n(lt),st=(n("fu2T"),n("gK9i")),ut=n("Pu9U");function dt(e){return function(){var t,n=p()(e);if(pt()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function pt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var mt,ft,ht,vt=st["a"].Panel,gt=function(e){c()(n,e);var t=dt(n);function n(e){var a;return r()(this,n),a=t.call(this,e),a.toggleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.handleSave=function(){var e=a.props.selectedRole,t=a.props,n=t.details,r=t.dispatch,i=[],o=function e(t){t&&t.forEach(function(t){var n=t.checked,a=t.id,r=t.children;n&&i.push(a),r&&e(r)})};o(n),a.toggleLoading(),$api.permissions.updateRolePermissions({role_id:e,route_ids:i},{success:!0}).then(function(e){a.toggleLoading(),r({type:"app/queryUserInfo"})})},a.handleItemChecked=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e&&e.target,r=n.checked,i=void 0!==r&&r,o=a.props.dispatch;o({type:"security/updatePermissionTree",payload:{checked:i,item:t}})},a.handleChangeAll=function(e){var t=e&&e.target,n=t.checked,r=void 0!==n&&n,i=a.props,o=i.dispatch,l=i.details,c=l&&ct()(l),s=function e(t){t&&t.forEach(function(t){t.checked=r,t.children&&e(t.children)})};s(c),o({type:"security/updateState",payload:{details:c}})},a.renderExpand=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isActive,n=void 0===t?"":t;return f.a.createElement(ut["a"],{className:Le()(Fe.a.expandIcon,Me()({},Fe.a.active,n))})},a.state={loading:!1},a}return o()(n,[{key:"renderCollapse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t&&t.length?t.map(function(t){var n=t.name,a=void 0===n?"":n,r=t.id,i=void 0===r?"":r,o=t.children,l=void 0===o?[]:o,c=t.checked,s=void 0!==c&&c;return f.a.createElement(st["a"],{expandIcon:e.renderExpand,expandIconPosition:"right",key:i},f.a.createElement(vt,{header:f.a.createElement("div",{style:{display:"inline-block"},onClick:function(e){e.stopPropagation()}},f.a.createElement(ot["a"],{checked:s,onChange:function(n){e.handleItemChecked(n,t)}},a))},e.renderSecondGroup(l)))}):null}},{key:"renderSecondGroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t||!t.length)return null;var n=t.length;return t.map(function(t,a){var r=t.name,i=void 0===r?"":r,o=t.id,l=void 0===o?"":o,c=t.children,s=void 0===c?[]:c,u=t.checked,d=void 0!==u&&u;return f.a.createElement("div",{key:l},f.a.createElement("div",{className:Fe.a.secondBox},f.a.createElement(ot["a"],{className:Fe.a.secondLabel,checked:d,onChange:function(n){e.handleItemChecked(n,t)}},f.a.createElement(v["r"],{text:i,maxLine:"1",style:{minWidth:"50px"}})),f.a.createElement("div",{className:Fe.a.thirdBox},e.renderThirdGroup(s))),a!==n-1&&f.a.createElement(ce["a"],{className:Fe.a.secondDivider}))})}},{key:"renderThirdGroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t&&t.length?t.map(function(t){var n=t.name,a=void 0===n?"":n,r=t.checked,i=void 0!==r&&r,o=t.id,l=void 0===o?"":o;return f.a.createElement(ot["a"],{key:l,checked:i,onChange:function(n){e.handleItemChecked(n,t)}},f.a.createElement(v["r"],{text:a,maxLine:"1",style:{minWidth:"50px"}}))}):null}},{key:"render",value:function(){var e=this.state.loading,t=this.props.details,n=void 0===t?[]:t,a=n&&n.every(function(e){return e.checked});return f.a.createElement("div",{className:Fe.a.permissions},f.a.createElement("div",{className:Fe.a.checkAll},f.a.createElement(ot["a"],{checked:a,onChange:this.handleChangeAll},"\u9009\u62e9\u5168\u90e8\u6743\u9650")),this.renderCollapse(n),$api.permissions.updateRolePermissions.permission()&&f.a.createElement(J["a"],{type:"primary",className:Fe.a.save,onClick:it()(this.handleSave,300),loading:e},"\u4fdd\u5b58"))}}]),n}(m["PureComponent"]),yt=gt;function Et(e){return function(){var t,n=p()(e);if(_t()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function _t(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var Rt,kt,bt,Ct=(mt=Object(h["connect"])(function(e){var t=e.security,n=e.loading;return D()({},t,{loading:n})}),mt((ht=function(e){c()(n,e);var t=Et(n);function n(e){var a;return r()(this,n),a=t.call(this,e),a.toggleLoading=function(){a.setState(function(e){return{loading:!e.loading}})},a.state={loading:!1},a}return o()(n,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"security/getPermissionTree"}).then(function(t){e({type:"security/getRolesList"})})}},{key:"render",value:function(){var e=this.props,t=e.roles,n=e.selectedRole,a=e.dispatch,r=e.details,i=e.loading,o=i.effects["security/createRole"]||i.effects["security/deleteRole"]||i.effects["security/updateRole"]||i.effects["security/updateRolesList"]||i.effects["security/getRolesList"];return f.a.createElement(v["x"],{className:Fe.a.page},o&&f.a.createElement("div",{className:Fe.a.loading},f.a.createElement(Ce["a"],null)),f.a.createElement("div",{className:Fe.a.container},f.a.createElement("div",{className:Fe.a.left},f.a.createElement(at,{roles:t,selectedRole:n,dispatch:a})),f.a.createElement("div",{className:Fe.a.right},f.a.createElement(yt,{details:r,selectedRole:n,dispatch:a}))))}}]),n}(f.a.PureComponent),ft=ht))||ft),Dt=Ct,xt=n("S2Nf"),Mt=n.n(xt);function St(e){return function(){var t,n=p()(e);if(Lt()){var a=p()(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return u()(this,t)}}function Lt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var wt=(Rt=Object(h["connect"])(function(e){var t=e.loading;return{loading:t}}),Rt((bt=function(e){c()(n,e);var t=St(n);function n(e){var a;return r()(this,n),a=t.call(this,e),a.onTabsChange=function(e){var t=e.value;a.setState({tab:t})},a.state={tab:y.MEMBERS},a}return o()(n,[{key:"render",value:function(){var e=this.state.tab;return f.a.createElement(v["x"],{inner:!0,className:Mt.a.page},f.a.createElement(v["E"],{defaultActiveKey:y.MEMBERS,tabs:E,onChange:this.onTabsChange}),e===y.MEMBERS?f.a.createElement(be,null):f.a.createElement(Dt,null))}}]),n}(m["PureComponent"]),kt=bt))||kt);t["default"]=wt},S2Nf:function(e,t,n){e.exports={page:"page___1pY_R"}},"f3b+":function(e,t,n){e.exports={page:"page___3MYwN",pageTitle:"pageTitle___2pKCi",container:"container___iF1GN",left:"left___3dmwv",right:"right___BFLVb",row:"row___fJsyG",roles:"roles___Er-xX",selectedRole:"selectedRole___3Hcl4",more:"more___o6pLA",editRole:"editRole___2acyI",addBtn:"addBtn___1n09e",addRole:"addRole___3wi_4",btns:"btns___2yB23",permissions:"permissions___25liM",width100:"width100___3T-mF",checkAll:"checkAll___2mMgK",expandIcon:"expandIcon___1vTi7",active:"active___3Xvfc",secondDivider:"secondDivider___2pRt0",secondBox:"secondBox___30of4",secondLabel:"secondLabel___1HQA_",thirdBox:"thirdBox___1MtR-",save:"save___6nVYr",loading:"loading___1HRh2",rolesList:"rolesList___4JjAO"}},wTCv:function(e,t,n){e.exports={page:"page___1MuM5",pageTitle:"pageTitle___PC5uS",container:"container___2xkvE"}}}]);